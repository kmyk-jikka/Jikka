<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Jikka.Core.Language.ModuloExpr</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Basic functions</span></span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier">ModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseModuloExpr"><span class="hs-identifier">parseModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopModuloExpr"><span class="hs-identifier">formatTopModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomModuloExpr"><span class="hs-identifier">formatBottomModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier">integerModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateModuloExpr"><span class="hs-identifier">negateModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier">plusModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier">minusModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier">multModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isZeroModuloExpr"><span class="hs-identifier">isZeroModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isOneModuloExpr"><span class="hs-identifier">isOneModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloOfModuloExpr"><span class="hs-identifier">moduloOfModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#arithmeticExprFromModuloExpr"><span class="hs-identifier">arithmeticExprFromModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier">formatModulo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-identifier">isModulo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Common.Error.html"><span class="hs-identifier">Jikka.Common.Error</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Format.html"><span class="hs-identifier">Jikka.Core.Format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Format.html#formatExpr"><span class="hs-identifier">formatExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ArithmeticExpr.html"><span class="hs-identifier">Jikka.Core.Language.ArithmeticExpr</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html"><span class="hs-identifier">Jikka.Core.Language.BuiltinPatterns</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html"><span class="hs-identifier">Jikka.Core.Language.Expr</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Runtime.html"><span class="hs-identifier">Jikka.Core.Language.Runtime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Runtime.html#modinv"><span class="hs-identifier">modinv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Runtime.html#modpow"><span class="hs-identifier">modpow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Util.html"><span class="hs-identifier">Jikka.Core.Language.Util</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | `Modulo` is just a newtype to avoid mistakes that swapping left and right of mod-op.</span><span>
</span><span id="line-37"></span><span class="hs-keyword">newtype</span><span> </span><span id="Modulo"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Modulo"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unModulo"><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680005076"><span id="local-6989586621680005078"><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
(Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool) -&gt; Eq Modulo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Modulo -&gt; Modulo -&gt; Bool
$c/= :: Modulo -&gt; Modulo -&gt; Bool
== :: Modulo -&gt; Modulo -&gt; Bool
$c== :: Modulo -&gt; Modulo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680005060"><span id="local-6989586621680005062"><span id="local-6989586621680005064"><span id="local-6989586621680005066"><span id="local-6989586621680005068"><span id="local-6989586621680005070"><span id="local-6989586621680005072"><span class="annot"><span class="annottext">Eq Modulo
Eq Modulo
-&gt; (Modulo -&gt; Modulo -&gt; Ordering)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Modulo)
-&gt; (Modulo -&gt; Modulo -&gt; Modulo)
-&gt; Ord Modulo
Modulo -&gt; Modulo -&gt; Bool
Modulo -&gt; Modulo -&gt; Ordering
Modulo -&gt; Modulo -&gt; Modulo
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Modulo -&gt; Modulo -&gt; Modulo
$cmin :: Modulo -&gt; Modulo -&gt; Modulo
max :: Modulo -&gt; Modulo -&gt; Modulo
$cmax :: Modulo -&gt; Modulo -&gt; Modulo
&gt;= :: Modulo -&gt; Modulo -&gt; Bool
$c&gt;= :: Modulo -&gt; Modulo -&gt; Bool
&gt; :: Modulo -&gt; Modulo -&gt; Bool
$c&gt; :: Modulo -&gt; Modulo -&gt; Bool
&lt;= :: Modulo -&gt; Modulo -&gt; Bool
$c&lt;= :: Modulo -&gt; Modulo -&gt; Bool
&lt; :: Modulo -&gt; Modulo -&gt; Bool
$c&lt; :: Modulo -&gt; Modulo -&gt; Bool
compare :: Modulo -&gt; Modulo -&gt; Ordering
$ccompare :: Modulo -&gt; Modulo -&gt; Ordering
$cp1Ord :: Eq Modulo
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680005053"><span id="local-6989586621680005055"><span id="local-6989586621680005057"><span class="annot"><span class="annottext">Int -&gt; Modulo -&gt; ShowS
[Modulo] -&gt; ShowS
Modulo -&gt; String
(Int -&gt; Modulo -&gt; ShowS)
-&gt; (Modulo -&gt; String) -&gt; ([Modulo] -&gt; ShowS) -&gt; Show Modulo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Modulo] -&gt; ShowS
$cshowList :: [Modulo] -&gt; ShowS
show :: Modulo -&gt; String
$cshow :: Modulo -&gt; String
showsPrec :: Int -&gt; Modulo -&gt; ShowS
$cshowsPrec :: Int -&gt; Modulo -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680005044"><span id="local-6989586621680005046"><span id="local-6989586621680005048"><span id="local-6989586621680005050"><span class="annot"><span class="annottext">ReadPrec [Modulo]
ReadPrec Modulo
Int -&gt; ReadS Modulo
ReadS [Modulo]
(Int -&gt; ReadS Modulo)
-&gt; ReadS [Modulo]
-&gt; ReadPrec Modulo
-&gt; ReadPrec [Modulo]
-&gt; Read Modulo
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Modulo]
$creadListPrec :: ReadPrec [Modulo]
readPrec :: ReadPrec Modulo
$creadPrec :: ReadPrec Modulo
readList :: ReadS [Modulo]
$creadList :: ReadS [Modulo]
readsPrec :: Int -&gt; ReadS Modulo
$creadsPrec :: Int -&gt; ReadS Modulo
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier hs-type">formatModulo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-41"></span><span id="formatModulo"><span class="annot"><span class="annottext">formatModulo :: Modulo -&gt; String
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier hs-var hs-var">formatModulo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.Core.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; String) -&gt; (Modulo -&gt; Expr) -&gt; Modulo -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-identifier hs-type">isModulo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-44"></span><span id="isModulo"><span class="annot"><span class="annottext">isModulo :: Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-identifier hs-var hs-var">isModulo</span></a></span></span><span> </span><span id="local-6989586621680005041"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005041"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span id="local-6989586621680005040"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005041"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-type">FloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005038"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005038"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005038"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005036"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005036"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005036"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-type">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005034"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005034"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005034"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-type">ModMinus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005032"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005032"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005032"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005030"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005030"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005030"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModInv%27"><span class="hs-identifier hs-type">ModInv'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005028"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005028"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005028"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-type">ModPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005026"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005026"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005026"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#VecFloorMod%27"><span class="hs-identifier hs-type">VecFloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005024"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005024"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005024"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#MatFloorMod%27"><span class="hs-identifier hs-type">MatFloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005022"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005022"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005022"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatAp%27"><span class="hs-identifier hs-type">ModMatAp'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005020"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005020"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005020"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatAdd%27"><span class="hs-identifier hs-type">ModMatAdd'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005018"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005018"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005018"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatMul%27"><span class="hs-identifier hs-type">ModMatMul'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005016"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005016"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005016"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatPow%27"><span class="hs-identifier hs-type">ModMatPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005014"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005014"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005014"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModSum%27"><span class="hs-identifier hs-type">ModSum'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005012"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005012"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005012"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModProduct%27"><span class="hs-identifier hs-type">ModProduct'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005010"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005010"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005010"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680005008"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680005008"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680005007"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680005007"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680005008"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680005008"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680005007"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Proj%27"><span class="hs-identifier hs-type">Proj'</span></a></span><span> </span><span id="local-6989586621680005002"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680005002"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680005001"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005001"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isVectorTy%27"><span class="hs-identifier hs-var">isVectorTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680005002"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005001"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Proj%27"><span class="hs-identifier hs-type">Proj'</span></a></span><span> </span><span id="local-6989586621680004999"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680004999"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004998"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004998"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isMatrixTy%27"><span class="hs-identifier hs-var">isMatrixTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680004999"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004998"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Map%27"><span class="hs-identifier hs-type">Map'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004995"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004995"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004995"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004993"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004993"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004993"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621680004992"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621680004992"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; (Expr, [Expr])
</span><a href="Jikka.Core.Language.Util.html#curryApp"><span class="hs-identifier hs-var">curryApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004992"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680004989"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621680004989"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004989"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Tuple%27"><span class="hs-identifier hs-type">Tuple'</span></a></span><span> </span><span id="local-6989586621680004987"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680004987"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004986"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004986"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isVectorTy%27"><span class="hs-identifier hs-var">isVectorTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680004987"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; [Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004986"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Tuple%27"><span class="hs-identifier hs-type">Tuple'</span></a></span><span> </span><span id="local-6989586621680004984"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680004984"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004983"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004983"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isMatrixTy%27"><span class="hs-identifier hs-var">isMatrixTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680004984"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; [Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680005040"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004983"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">(Expr, [Expr])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">data</span><span> </span><span id="ProductExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-var">ProductExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProductExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-var">ProductExpr</span></a></span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="productExprConst"><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span id="productExprList"><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span id="productExprInvList"><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680004975"><span id="local-6989586621680004977"><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Bool
(ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool) -&gt; Eq ProductExpr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c/= :: ProductExpr -&gt; ProductExpr -&gt; Bool
== :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c== :: ProductExpr -&gt; ProductExpr -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004960"><span id="local-6989586621680004962"><span id="local-6989586621680004964"><span id="local-6989586621680004966"><span id="local-6989586621680004968"><span id="local-6989586621680004970"><span id="local-6989586621680004972"><span class="annot"><span class="annottext">Eq ProductExpr
Eq ProductExpr
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Ordering)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; ProductExpr)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; ProductExpr)
-&gt; Ord ProductExpr
ProductExpr -&gt; ProductExpr -&gt; Bool
ProductExpr -&gt; ProductExpr -&gt; Ordering
ProductExpr -&gt; ProductExpr -&gt; ProductExpr
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
$cmin :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
max :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
$cmax :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
&gt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&gt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
&gt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&gt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
&lt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&lt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
&lt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&lt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
compare :: ProductExpr -&gt; ProductExpr -&gt; Ordering
$ccompare :: ProductExpr -&gt; ProductExpr -&gt; Ordering
$cp1Ord :: Eq ProductExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004954"><span id="local-6989586621680004956"><span id="local-6989586621680004958"><span class="annot"><span class="annottext">Int -&gt; ProductExpr -&gt; ShowS
[ProductExpr] -&gt; ShowS
ProductExpr -&gt; String
(Int -&gt; ProductExpr -&gt; ShowS)
-&gt; (ProductExpr -&gt; String)
-&gt; ([ProductExpr] -&gt; ShowS)
-&gt; Show ProductExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProductExpr] -&gt; ShowS
$cshowList :: [ProductExpr] -&gt; ShowS
show :: ProductExpr -&gt; String
$cshow :: ProductExpr -&gt; String
showsPrec :: Int -&gt; ProductExpr -&gt; ShowS
$cshowsPrec :: Int -&gt; ProductExpr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004946"><span id="local-6989586621680004948"><span id="local-6989586621680004950"><span id="local-6989586621680004952"><span class="annot"><span class="annottext">ReadPrec [ProductExpr]
ReadPrec ProductExpr
Int -&gt; ReadS ProductExpr
ReadS [ProductExpr]
(Int -&gt; ReadS ProductExpr)
-&gt; ReadS [ProductExpr]
-&gt; ReadPrec ProductExpr
-&gt; ReadPrec [ProductExpr]
-&gt; Read ProductExpr
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [ProductExpr]
$creadListPrec :: ReadPrec [ProductExpr]
readPrec :: ReadPrec ProductExpr
$creadPrec :: ReadPrec ProductExpr
readList :: ReadS [ProductExpr]
$creadList :: ReadS [ProductExpr]
readsPrec :: Int -&gt; ReadS ProductExpr
$creadsPrec :: Int -&gt; ReadS ProductExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="SumExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-var">SumExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SumExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-var">SumExpr</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sumExprList"><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span id="sumExprConst"><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680004939"><span id="local-6989586621680004941"><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; Bool
(SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool) -&gt; Eq SumExpr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SumExpr -&gt; SumExpr -&gt; Bool
$c/= :: SumExpr -&gt; SumExpr -&gt; Bool
== :: SumExpr -&gt; SumExpr -&gt; Bool
$c== :: SumExpr -&gt; SumExpr -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004924"><span id="local-6989586621680004926"><span id="local-6989586621680004928"><span id="local-6989586621680004930"><span id="local-6989586621680004932"><span id="local-6989586621680004934"><span id="local-6989586621680004936"><span class="annot"><span class="annottext">Eq SumExpr
Eq SumExpr
-&gt; (SumExpr -&gt; SumExpr -&gt; Ordering)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; SumExpr)
-&gt; (SumExpr -&gt; SumExpr -&gt; SumExpr)
-&gt; Ord SumExpr
SumExpr -&gt; SumExpr -&gt; Bool
SumExpr -&gt; SumExpr -&gt; Ordering
SumExpr -&gt; SumExpr -&gt; SumExpr
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: SumExpr -&gt; SumExpr -&gt; SumExpr
$cmin :: SumExpr -&gt; SumExpr -&gt; SumExpr
max :: SumExpr -&gt; SumExpr -&gt; SumExpr
$cmax :: SumExpr -&gt; SumExpr -&gt; SumExpr
&gt;= :: SumExpr -&gt; SumExpr -&gt; Bool
$c&gt;= :: SumExpr -&gt; SumExpr -&gt; Bool
&gt; :: SumExpr -&gt; SumExpr -&gt; Bool
$c&gt; :: SumExpr -&gt; SumExpr -&gt; Bool
&lt;= :: SumExpr -&gt; SumExpr -&gt; Bool
$c&lt;= :: SumExpr -&gt; SumExpr -&gt; Bool
&lt; :: SumExpr -&gt; SumExpr -&gt; Bool
$c&lt; :: SumExpr -&gt; SumExpr -&gt; Bool
compare :: SumExpr -&gt; SumExpr -&gt; Ordering
$ccompare :: SumExpr -&gt; SumExpr -&gt; Ordering
$cp1Ord :: Eq SumExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004918"><span id="local-6989586621680004920"><span id="local-6989586621680004922"><span class="annot"><span class="annottext">Int -&gt; SumExpr -&gt; ShowS
[SumExpr] -&gt; ShowS
SumExpr -&gt; String
(Int -&gt; SumExpr -&gt; ShowS)
-&gt; (SumExpr -&gt; String) -&gt; ([SumExpr] -&gt; ShowS) -&gt; Show SumExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SumExpr] -&gt; ShowS
$cshowList :: [SumExpr] -&gt; ShowS
show :: SumExpr -&gt; String
$cshow :: SumExpr -&gt; String
showsPrec :: Int -&gt; SumExpr -&gt; ShowS
$cshowsPrec :: Int -&gt; SumExpr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004910"><span id="local-6989586621680004912"><span id="local-6989586621680004914"><span id="local-6989586621680004916"><span class="annot"><span class="annottext">ReadPrec [SumExpr]
ReadPrec SumExpr
Int -&gt; ReadS SumExpr
ReadS [SumExpr]
(Int -&gt; ReadS SumExpr)
-&gt; ReadS [SumExpr]
-&gt; ReadPrec SumExpr
-&gt; ReadPrec [SumExpr]
-&gt; Read SumExpr
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [SumExpr]
$creadListPrec :: ReadPrec [SumExpr]
readPrec :: ReadPrec SumExpr
$creadPrec :: ReadPrec SumExpr
readList :: ReadS [SumExpr]
$creadList :: ReadS [SumExpr]
readsPrec :: Int -&gt; ReadS SumExpr
$creadsPrec :: Int -&gt; ReadS SumExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">data</span><span> </span><span id="ModuloExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ModuloExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="unModuloExpr"><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>    </span><span id="modulo"><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680004901"><span id="local-6989586621680004903"><span id="local-6989586621680004905"><span class="annot"><span class="annottext">Int -&gt; ModuloExpr -&gt; ShowS
[ModuloExpr] -&gt; ShowS
ModuloExpr -&gt; String
(Int -&gt; ModuloExpr -&gt; ShowS)
-&gt; (ModuloExpr -&gt; String)
-&gt; ([ModuloExpr] -&gt; ShowS)
-&gt; Show ModuloExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ModuloExpr] -&gt; ShowS
$cshowList :: [ModuloExpr] -&gt; ShowS
show :: ModuloExpr -&gt; String
$cshow :: ModuloExpr -&gt; String
showsPrec :: Int -&gt; ModuloExpr -&gt; ShowS
$cshowsPrec :: Int -&gt; ModuloExpr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680004898"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621680004897"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004897"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004896"><span class="annot"><span class="annottext">== :: ModuloExpr -&gt; ModuloExpr -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621680004895"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004895"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004897"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004895"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004897"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004895"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680004880"><span id="local-6989586621680004882"><span id="local-6989586621680004884"><span id="local-6989586621680004886"><span id="local-6989586621680004888"><span id="local-6989586621680004890"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621680004879"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004879"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004878"><span class="annot"><span class="annottext">compare :: ModuloExpr -&gt; ModuloExpr -&gt; Ordering
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`compare`</span></span></span><span> </span><span id="local-6989586621680004876"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004876"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004879"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004879"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr, Modulo) -&gt; (SumExpr, Modulo) -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004876"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004876"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-type">negateProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-100"></span><span id="negateProductExpr"><span class="annot"><span class="annottext">negateProductExpr :: ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var hs-var">negateProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004874"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004874"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004874"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004874"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-type">multProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-103"></span><span id="multProductExpr"><span class="annot"><span class="annottext">multProductExpr :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var hs-var">multProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004872"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004872"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004871"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004871"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004872"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004871"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004872"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004871"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004872"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004871"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-type">powProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-111"></span><span id="powProductExpr"><span class="annot"><span class="annottext">powProductExpr :: Integer -&gt; ProductExpr -&gt; Integer -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-var hs-var">powProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004868"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004868"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004867"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004867"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680004866"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004866"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error Integer -&gt; Integer
forall a. Either Error a -&gt; a
</span><a href="Jikka.Common.Error.html#fromSuccess"><span class="hs-identifier hs-var">fromSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Error Integer -&gt; Integer)
-&gt; Either Error Integer -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Either Error Integer
forall (m :: * -&gt; *).
MonadError Error m =&gt;
Integer -&gt; Integer -&gt; Integer -&gt; m Integer
</span><a href="Jikka.Core.Language.Runtime.html#modpow"><span class="hs-identifier hs-var">modpow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004867"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004866"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004868"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680004864"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004864"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-var">ModPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004864"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004866"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004868"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004867"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680004863"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004863"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-var">ModPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004863"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004866"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004868"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004867"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="local-6989586621680005130"><span id="local-6989586621680005131"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-type">partitionMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680005131"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621680005130"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680005131"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680005130"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680005131"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-119"></span><span id="partitionMaybe"><span class="annot"><span class="annottext">partitionMaybe :: (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-var hs-var">partitionMaybe</span></a></span></span><span> </span><span id="local-6989586621680004861"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621680004861"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621680004860"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680004860"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680004859"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680004859"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680004858"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680004858"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004857"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680004857"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-var">partitionMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621680004861"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680004859"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-123"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621680004861"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680004860"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-124"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680004856"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680004856"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680004856"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680004858"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680004857"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>          </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680004858"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680004860"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680004857"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-type">fromLitInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-128"></span><span id="fromLitInt"><span class="annot"><span class="annottext">fromLitInt :: Expr -&gt; Maybe Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-var hs-var">fromLitInt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004854"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004854"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004854"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-var">fromLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-type">invProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-132"></span><span id="invProductExpr"><span class="annot"><span class="annottext">invProductExpr :: Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-var hs-var">invProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004852"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004852"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004851"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004851"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680004850"><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621680004850"><span class="hs-identifier hs-var">invKs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680004849"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004849"><span class="hs-identifier hs-var">invList</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Maybe Integer) -&gt; [Expr] -&gt; ([Integer], [Expr])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-var">partitionMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-var">fromLitInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004851"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621680004848"><span class="annot"><span class="annottext">e' :: ProductExpr
</span><a href="#local-6989586621680004848"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-136"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621680004850"><span class="hs-identifier hs-var">invKs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>            </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004851"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Expr] -&gt; [Expr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004849"><span class="hs-identifier hs-var">invList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>            </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004851"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004852"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004846"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004846"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Either Error Integer
forall (m :: * -&gt; *).
MonadError Error m =&gt;
Integer -&gt; Integer -&gt; m Integer
</span><a href="Jikka.Core.Language.Runtime.html#modinv"><span class="hs-identifier hs-var">modinv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004851"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004846"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680004845"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004845"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-144"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004845"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621680004850"><span class="hs-identifier hs-var">invKs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004846"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>                </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004849"><span class="hs-identifier hs-var">invList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>                </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004851"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-147"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>          </span><span class="annot"><span class="annottext">Either Error Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004848"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004848"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-type">isInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-152"></span><span id="isInteger"><span class="annot"><span class="annottext">isInteger :: Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-var hs-var">isInteger</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-var">isInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-type">moduloToInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-156"></span><span id="moduloToInteger"><span class="annot"><span class="annottext">moduloToInteger :: Modulo -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-var hs-var">moduloToInteger</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004841"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004841"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004841"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-var">moduloToInteger</span></a></span><span> </span><span id="local-6989586621680004840"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004840"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Integer
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Integer) -&gt; String -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Jikka.Core.Language.ModuloExpr.moduloToInteger: modulo is not an integer&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; String
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier hs-var">formatModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004840"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-type">parseProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-160"></span><span id="parseProductExpr"><span class="annot"><span class="annottext">parseProductExpr :: Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var hs-var">parseProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004837"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004836"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004836"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004836"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Negate%27"><span class="hs-identifier hs-type">Negate'</span></a></span><span> </span><span id="local-6989586621680004834"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004834"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var">negateProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004834"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-type">Mult'</span></a></span><span> </span><span id="local-6989586621680004832"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004832"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004831"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004831"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004832"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004831"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#JustDiv%27"><span class="hs-identifier hs-type">JustDiv'</span></a></span><span> </span><span id="local-6989586621680004829"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004829"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004828"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004828"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004829"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-var">invProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004828"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Pow%27"><span class="hs-identifier hs-type">Pow'</span></a></span><span> </span><span id="local-6989586621680004826"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004826"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004825"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004825"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-var">isInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ProductExpr -&gt; Integer -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-var">powProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-var">moduloToInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004826"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004825"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span id="local-6989586621680004824"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004824"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680004823"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004823"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004823"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var">negateProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004824"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span id="local-6989586621680004822"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004822"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004821"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004821"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680004820"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004820"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004820"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004822"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004821"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-type">ModPow'</span></a></span><span> </span><span id="local-6989586621680004819"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004819"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004818"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004818"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004817"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004817"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004817"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ProductExpr -&gt; Integer -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-var">powProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004817"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004819"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004818"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModInv%27"><span class="hs-identifier hs-type">ModInv'</span></a></span><span> </span><span id="local-6989586621680004816"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004816"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004815"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004815"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004815"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-var">invProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004837"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004816"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621680004814"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004814"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004814"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#sumExprFromProductExpr"><span class="hs-identifier hs-type">sumExprFromProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-173"></span><span id="sumExprFromProductExpr"><span class="annot"><span class="annottext">sumExprFromProductExpr :: ProductExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprFromProductExpr"><span class="hs-identifier hs-var hs-var">sumExprFromProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004812"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004812"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004812"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#integerSumExpr"><span class="hs-identifier hs-type">integerSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-180"></span><span id="integerSumExpr"><span class="annot"><span class="annottext">integerSumExpr :: Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerSumExpr"><span class="hs-identifier hs-var hs-var">integerSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004810"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004810"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004810"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-type">integerModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-187"></span><span id="integerModuloExpr"><span class="annot"><span class="annottext">integerModuloExpr :: Modulo -&gt; Integer -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-var hs-var">integerModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004809"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004809"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004808"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004808"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerSumExpr"><span class="hs-identifier hs-var">integerSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004808"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004809"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-type">negateSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-190"></span><span id="negateSumExpr"><span class="annot"><span class="annottext">negateSumExpr :: SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var hs-var">negateSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004806"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004806"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var">negateProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004806"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004806"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-type">plusSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-197"></span><span id="plusSumExpr"><span class="annot"><span class="annottext">plusSumExpr :: SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var hs-var">plusSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004804"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004804"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004803"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004803"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004804"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr] -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004803"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004804"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004803"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-type">multSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-204"></span><span id="multSumExpr"><span class="annot"><span class="annottext">multSumExpr :: Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var hs-var">multSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004800"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004800"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004799"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004799"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004798"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004798"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680004797"><span class="annot"><span class="annottext">es1 :: [ProductExpr]
</span><a href="#local-6989586621680004797"><span class="hs-identifier hs-var hs-var">es1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004800"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004799"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004799"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span id="local-6989586621680004796"><span class="annot"><span class="annottext">es2 :: [ProductExpr]
</span><a href="#local-6989586621680004796"><span class="hs-identifier hs-var hs-var">es2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004800"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004798"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004798"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-209"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[ProductExpr] -&gt; [ProductExpr]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([ProductExpr] -&gt; [ProductExpr]) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ProductExpr, ProductExpr) -&gt; ProductExpr)
-&gt; [(ProductExpr, ProductExpr)] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; ProductExpr)
-&gt; (ProductExpr, ProductExpr) -&gt; ProductExpr
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; (ProductExpr, ProductExpr))
-&gt; [ProductExpr] -&gt; [ProductExpr -&gt; (ProductExpr, ProductExpr)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004797"><span class="hs-identifier hs-var">es1</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr -&gt; (ProductExpr, ProductExpr)]
-&gt; [ProductExpr] -&gt; [(ProductExpr, ProductExpr)]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004796"><span class="hs-identifier hs-var">es2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004799"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004798"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateModuloExpr"><span class="hs-identifier hs-type">negateModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-214"></span><span id="negateModuloExpr"><span class="annot"><span class="annottext">negateModuloExpr :: ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateModuloExpr"><span class="hs-identifier hs-var hs-var">negateModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621680004792"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004792"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680004791"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004791"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004792"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004791"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier hs-type">plusModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-217"></span><span id="plusModuloExpr"><span class="annot"><span class="annottext">plusModuloExpr :: ModuloExpr -&gt; ModuloExpr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier hs-var hs-var">plusModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621680004790"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004790"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004789"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004789"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621680004788"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004788"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680004787"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004787"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004789"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004787"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004790"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004788"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004789"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier hs-var">plusModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuloExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier hs-type">minusModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-221"></span><span id="minusModuloExpr"><span class="annot"><span class="annottext">minusModuloExpr :: ModuloExpr -&gt; ModuloExpr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier hs-var hs-var">minusModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621680004786"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004786"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004785"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004785"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621680004784"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004784"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680004783"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004783"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004785"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004783"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004786"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004784"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004785"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier hs-var">minusModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuloExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier hs-type">multModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-225"></span><span id="multModuloExpr"><span class="annot"><span class="annottext">multModuloExpr :: ModuloExpr -&gt; ModuloExpr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier hs-var hs-var">multModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621680004782"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004782"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004781"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004781"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621680004780"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004780"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680004779"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004779"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004781"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004779"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var">multSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004781"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004782"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004780"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004781"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier hs-var">multModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuloExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-type">parseSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-229"></span><span id="parseSumExpr"><span class="annot"><span class="annottext">parseSumExpr :: Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var hs-var">parseSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004777"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004776"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004776"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004776"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Negate%27"><span class="hs-identifier hs-type">Negate'</span></a></span><span> </span><span id="local-6989586621680004775"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004775"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004775"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Plus%27"><span class="hs-identifier hs-type">Plus'</span></a></span><span> </span><span id="local-6989586621680004773"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004773"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004772"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004772"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004773"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004772"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Minus%27"><span class="hs-identifier hs-type">Minus'</span></a></span><span> </span><span id="local-6989586621680004770"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004770"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004769"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004769"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004770"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004769"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-type">Mult'</span></a></span><span> </span><span id="local-6989586621680004768"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004768"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004767"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004767"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var">multSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004768"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004767"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-type">FloorMod'</span></a></span><span> </span><span id="local-6989586621680004766"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004766"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680004765"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004765"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004765"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004766"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span id="local-6989586621680004764"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004764"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680004763"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004763"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004763"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004764"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-type">ModPlus'</span></a></span><span> </span><span id="local-6989586621680004762"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004762"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004761"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004761"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680004760"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004760"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004760"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004762"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004761"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-type">ModMinus'</span></a></span><span> </span><span id="local-6989586621680004759"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004759"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004758"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004758"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680004757"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004757"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004757"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004759"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004758"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span id="local-6989586621680004756"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004756"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004755"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004755"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680004754"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004754"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004754"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var">multSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004756"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004755"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621680004753"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004753"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprFromProductExpr"><span class="hs-identifier hs-var">sumExprFromProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004753"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#getModuloFromExpr"><span class="hs-identifier hs-type">getModuloFromExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span>
</span><span id="line-243"></span><span id="getModuloFromExpr"><span class="annot"><span class="annottext">getModuloFromExpr :: Expr -&gt; Maybe Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#getModuloFromExpr"><span class="hs-identifier hs-var hs-var">getModuloFromExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-type">FloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004751"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004751"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004751"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004750"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004750"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004750"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-type">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004749"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004749"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004749"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-type">ModMinus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004748"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004748"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004748"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680004747"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004747"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004747"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Modulo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | `parseModuloExpr` converts a given expr to a normal form \(\sum_i \prod_j e _ {i,j}) \bmod m\).</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- This assumes given exprs have the type \(\mathbf{int}\).</span><span>
</span><span id="line-253"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseModuloExpr"><span class="hs-identifier hs-type">parseModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-254"></span><span id="parseModuloExpr"><span class="annot"><span class="annottext">parseModuloExpr :: Expr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseModuloExpr"><span class="hs-identifier hs-var hs-var">parseModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004746"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004746"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621680004745"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004745"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#getModuloFromExpr"><span class="hs-identifier hs-var">getModuloFromExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004746"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004745"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004746"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004745"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-type">formatTopProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-259"></span><span id="formatTopProductExpr"><span class="annot"><span class="annottext">formatTopProductExpr :: Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-var hs-var">formatTopProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004743"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004743"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004742"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004742"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680004741"><span class="annot"><span class="annottext">k :: Expr
</span><a href="#local-6989586621680004741"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004742"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>      </span><span id="local-6989586621680004740"><span class="annot"><span class="annottext">k' :: Expr -&gt; Expr
</span><a href="#local-6989586621680004740"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621680004739"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004739"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004742"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004739"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Negate%27"><span class="hs-identifier hs-var">Negate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004739"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-var">Mult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004739"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004741"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621680004738"><span class="annot"><span class="annottext">invList :: [Expr]
</span><a href="#local-6989586621680004738"><span class="hs-identifier hs-var hs-var">invList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-operator hs-var">`FloorMod'`</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004743"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004742"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004742"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004738"><span class="hs-identifier hs-var">invList</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004741"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span id="local-6989586621680004737"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004737"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680004736"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004736"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621680004740"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; Expr -&gt; Expr) -&gt; Expr -&gt; [Expr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-var">Mult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004737"><span class="hs-identifier hs-var">eHead</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004736"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-type">formatTopSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-272"></span><span id="formatTopSumExpr"><span class="annot"><span class="annottext">formatTopSumExpr :: Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-var hs-var">formatTopSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004733"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004733"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004732"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004732"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004732"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004732"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621680004731"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004731"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680004730"><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004730"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680004729"><span class="annot"><span class="annottext">op :: ProductExpr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621680004729"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680004728"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004728"><span class="hs-identifier hs-var">e'</span></a></span></span><span>
</span><span id="line-276"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004728"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Plus%27"><span class="hs-identifier hs-var">Plus'</span></a></span><span>
</span><span id="line-277"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004728"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Minus%27"><span class="hs-identifier hs-var">Minus'</span></a></span><span>
</span><span id="line-278"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-279"></span><span>        </span><span id="local-6989586621680004725"><span class="annot"><span class="annottext">go :: Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621680004725"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680004724"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004724"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004723"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004723"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621680004729"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004723"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004724"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-var">formatTopProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004733"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004723"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004723"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>        </span><span id="local-6989586621680004721"><span class="annot"><span class="annottext">k' :: Expr -&gt; Expr
</span><a href="#local-6989586621680004721"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621680004720"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004720"><span class="hs-identifier hs-var">e'</span></a></span></span><span>
</span><span id="line-281"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004732"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Plus%27"><span class="hs-identifier hs-var">Plus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004720"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004732"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004732"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Minus%27"><span class="hs-identifier hs-var">Minus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004720"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004732"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004720"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-284"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621680004721"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; ProductExpr -&gt; Expr) -&gt; Expr -&gt; [ProductExpr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621680004725"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-var">formatTopProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004733"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004731"><span class="hs-identifier hs-var">eHead</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004730"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | `formatTopModuloExpr` convert `ModuloExpr` to `Expr` with adding `FloorMod` at only the root.</span><span>
</span><span id="line-287"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopModuloExpr"><span class="hs-identifier hs-type">formatTopModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-288"></span><span id="formatTopModuloExpr"><span class="annot"><span class="annottext">formatTopModuloExpr :: ModuloExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopModuloExpr"><span class="hs-identifier hs-var hs-var">formatTopModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004719"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004719"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-var">FloorMod'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-var">formatTopSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004719"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr -&gt; Expr) -&gt; (ModuloExpr -&gt; SumExpr) -&gt; ModuloExpr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Expr) -&gt; ModuloExpr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004719"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Expr) -&gt; Modulo -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004719"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-type">formatBottomInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-291"></span><span id="formatBottomInteger"><span class="annot"><span class="annottext">formatBottomInteger :: Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var hs-var">formatBottomInteger</span></a></span></span><span> </span><span id="local-6989586621680004717"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004717"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004716"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004716"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004717"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004715"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004715"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004716"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004715"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621680004714"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004714"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-var">FloorMod'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004716"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004714"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-type">formatBottomProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-296"></span><span id="formatBottomProductExpr"><span class="annot"><span class="annottext">formatBottomProductExpr :: Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var hs-var">formatBottomProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004712"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004711"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004711"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680004710"><span class="annot"><span class="annottext">k :: Expr
</span><a href="#local-6989586621680004710"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var">formatBottomInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004711"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>      </span><span id="local-6989586621680004709"><span class="annot"><span class="annottext">k' :: Expr -&gt; Expr
</span><a href="#local-6989586621680004709"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621680004708"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004708"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004711"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004708"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-var">ModNegate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004708"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-var">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004708"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004710"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621680004707"><span class="annot"><span class="annottext">invList :: [Expr]
</span><a href="#local-6989586621680004707"><span class="hs-identifier hs-var hs-var">invList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModInv%27"><span class="hs-operator hs-var">`ModInv'`</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004711"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>      </span><span id="local-6989586621680004706"><span class="annot"><span class="annottext">list :: [Expr]
</span><a href="#local-6989586621680004706"><span class="hs-identifier hs-var hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680004705"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004705"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004705"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004705"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-var">FloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004705"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004711"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004706"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004707"><span class="hs-identifier hs-var">invList</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004710"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-307"></span><span>        </span><span id="local-6989586621680004704"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004704"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680004703"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004703"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621680004709"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; Expr -&gt; Expr) -&gt; Expr -&gt; [Expr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680004702"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004702"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004701"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004701"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-var">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004702"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004701"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004712"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004704"><span class="hs-identifier hs-var">eHead</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004703"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomSumExpr"><span class="hs-identifier hs-type">formatBottomSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-310"></span><span id="formatBottomSumExpr"><span class="annot"><span class="annottext">formatBottomSumExpr :: Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomSumExpr"><span class="hs-identifier hs-var hs-var">formatBottomSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004699"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004698"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004698"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004698"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var">formatBottomInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004698"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621680004697"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004697"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680004696"><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004696"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680004695"><span class="annot"><span class="annottext">go :: Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621680004695"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680004694"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004694"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004693"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004693"><span class="hs-identifier hs-var">e2</span></a></span></span><span>
</span><span id="line-314"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004693"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004694"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-315"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004693"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-var">ModMinus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004694"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var">formatBottomProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004693"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-var">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004694"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var">formatBottomProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004693"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621680004692"><span class="annot"><span class="annottext">plusConst :: Expr -&gt; Expr
</span><a href="#local-6989586621680004692"><span class="hs-identifier hs-var hs-var">plusConst</span></a></span></span><span> </span><span id="local-6989586621680004691"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004691"><span class="hs-identifier hs-var">e'</span></a></span></span><span>
</span><span id="line-318"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004698"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004691"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-319"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-var">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680004691"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var">formatBottomInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004698"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621680004692"><span class="hs-identifier hs-var">plusConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; ProductExpr -&gt; Expr) -&gt; Expr -&gt; [ProductExpr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621680004695"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var">formatBottomProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004699"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004697"><span class="hs-identifier hs-var">eHead</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004696"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | `formatBottomModuloExpr` convert `ModuloExpr` to `Expr` with adding `FloorMod` at every nodes.</span><span>
</span><span id="line-323"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomModuloExpr"><span class="hs-identifier hs-type">formatBottomModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-324"></span><span id="formatBottomModuloExpr"><span class="annot"><span class="annottext">formatBottomModuloExpr :: ModuloExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomModuloExpr"><span class="hs-identifier hs-var hs-var">formatBottomModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004690"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004690"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomSumExpr"><span class="hs-identifier hs-var">formatBottomSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004690"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr -&gt; Expr) -&gt; (ModuloExpr -&gt; SumExpr) -&gt; ModuloExpr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Expr) -&gt; ModuloExpr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004690"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#normalizeProductExpr"><span class="hs-identifier hs-type">normalizeProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-327"></span><span id="normalizeProductExpr"><span class="annot"><span class="annottext">normalizeProductExpr :: Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeProductExpr"><span class="hs-identifier hs-var hs-var">normalizeProductExpr</span></a></span></span><span> </span><span id="local-6989586621680004688"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004688"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004687"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004687"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680004686"><span class="annot"><span class="annottext">k :: Integer
</span><a href="#local-6989586621680004686"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004688"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004685"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004685"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004687"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004685"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004687"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span id="local-6989586621680004684"><span class="annot"><span class="annottext">es :: [Expr]
</span><a href="#local-6989586621680004684"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004686"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-333"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-334"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004687"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>      </span><span id="local-6989586621680004682"><span class="annot"><span class="annottext">es' :: [Expr]
</span><a href="#local-6989586621680004682"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004686"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-337"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004687"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004687"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004684"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>          </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680004682"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>          </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004686"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#normalizeSumExpr"><span class="hs-identifier hs-type">normalizeSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-346"></span><span id="normalizeSumExpr"><span class="annot"><span class="annottext">normalizeSumExpr :: Modulo -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeSumExpr"><span class="hs-identifier hs-var hs-var">normalizeSumExpr</span></a></span></span><span> </span><span id="local-6989586621680004680"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004680"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680004679"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004679"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680004678"><span class="annot"><span class="annottext">f :: ProductExpr -&gt; ([Expr], [Expr])
</span><a href="#local-6989586621680004678"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680004677"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004677"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004677"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004677"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>      </span><span id="local-6989586621680004676"><span class="annot"><span class="annottext">cmp :: ProductExpr -&gt; ProductExpr -&gt; Ordering
</span><a href="#local-6989586621680004676"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621680004675"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004675"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004674"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004674"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ([Expr], [Expr])
</span><a href="#local-6989586621680004678"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004675"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">([Expr], [Expr]) -&gt; ([Expr], [Expr]) -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ([Expr], [Expr])
</span><a href="#local-6989586621680004678"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004674"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-349"></span><span>      </span><span id="local-6989586621680004673"><span class="annot"><span class="annottext">cmp' :: ProductExpr -&gt; ProductExpr -&gt; Bool
</span><a href="#local-6989586621680004673"><span class="hs-identifier hs-var hs-var">cmp'</span></a></span></span><span> </span><span id="local-6989586621680004672"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004672"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680004671"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004671"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Ordering
</span><a href="#local-6989586621680004676"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004672"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004671"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-350"></span><span>      </span><span id="local-6989586621680004670"><span class="annot"><span class="annottext">es :: [ProductExpr]
</span><a href="#local-6989586621680004670"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; Ordering)
-&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Ordering
</span><a href="#local-6989586621680004676"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeProductExpr"><span class="hs-identifier hs-var">normalizeProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004680"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004679"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>      </span><span id="local-6989586621680004668"><span class="annot"><span class="annottext">es' :: [[ProductExpr]]
</span><a href="#local-6989586621680004668"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; [ProductExpr] -&gt; [[ProductExpr]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">groupBy</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Bool
</span><a href="#local-6989586621680004673"><span class="hs-identifier hs-var">cmp'</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004670"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span id="local-6989586621680004666"><span class="annot"><span class="annottext">es'' :: [ProductExpr]
</span><a href="#local-6989586621680004666"><span class="hs-identifier hs-var hs-var">es''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">([ProductExpr] -&gt; ProductExpr) -&gt; [[ProductExpr]] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-354"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680004665"><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004665"><span class="hs-identifier hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>              </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-356"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; Integer) -&gt; [ProductExpr] -&gt; [Integer]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004665"><span class="hs-identifier hs-var">group</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-357"></span><span>                  </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProductExpr] -&gt; ProductExpr
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004665"><span class="hs-identifier hs-var">group</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-358"></span><span>                  </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProductExpr] -&gt; ProductExpr
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004665"><span class="hs-identifier hs-var">group</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-360"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>          </span><span class="annot"><span class="annottext">[[ProductExpr]]
</span><a href="#local-6989586621680004668"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-362"></span><span>      </span><span id="local-6989586621680004662"><span class="annot"><span class="annottext">es''' :: [ProductExpr]
</span><a href="#local-6989586621680004662"><span class="hs-identifier hs-var hs-var">es'''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; Bool) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680004661"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004661"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004661"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004661"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004666"><span class="hs-identifier hs-var">es''</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span id="local-6989586621680004657"><span class="annot"><span class="annottext">k :: Integer
</span><a href="#local-6989586621680004657"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; Integer) -&gt; [ProductExpr] -&gt; [Integer]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680004656"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004656"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004656"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621680004656"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004666"><span class="hs-identifier hs-var">es''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>      </span><span id="local-6989586621680004655"><span class="annot"><span class="annottext">k' :: Integer
</span><a href="#local-6989586621680004655"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621680004679"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004657"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621680004654"><span class="annot"><span class="annottext">k'' :: Integer
</span><a href="#local-6989586621680004654"><span class="hs-identifier hs-var hs-var">k''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621680004680"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621680004653"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004653"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004655"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004653"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004655"><span class="hs-identifier hs-var">k'</span></a></span><span>
</span><span id="line-368"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621680004662"><span class="hs-identifier hs-var">es'''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680004654"><span class="hs-identifier hs-var">k''</span></a></span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-type">normalizeModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-374"></span><span id="normalizeModuloExpr"><span class="annot"><span class="annottext">normalizeModuloExpr :: ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var hs-var">normalizeModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004652"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004652"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeSumExpr"><span class="hs-identifier hs-var">normalizeSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004652"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004652"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004652"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isZeroModuloExpr"><span class="hs-identifier hs-type">isZeroModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-377"></span><span id="isZeroModuloExpr"><span class="annot"><span class="annottext">isZeroModuloExpr :: ModuloExpr -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isZeroModuloExpr"><span class="hs-identifier hs-var hs-var">isZeroModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004651"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004651"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004651"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-var">integerModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004651"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isOneModuloExpr"><span class="hs-identifier hs-type">isOneModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-380"></span><span id="isOneModuloExpr"><span class="annot"><span class="annottext">isOneModuloExpr :: ModuloExpr -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isOneModuloExpr"><span class="hs-identifier hs-var hs-var">isOneModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004650"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004650"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004650"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-var">integerModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004650"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloOfModuloExpr"><span class="hs-identifier hs-type">moduloOfModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-383"></span><span id="moduloOfModuloExpr"><span class="annot"><span class="annottext">moduloOfModuloExpr :: ModuloExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#moduloOfModuloExpr"><span class="hs-identifier hs-var hs-var">moduloOfModuloExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Expr) -&gt; (ModuloExpr -&gt; Modulo) -&gt; ModuloExpr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#arithmeticExprFromModuloExpr"><span class="hs-identifier hs-type">arithmeticExprFromModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ArithmeticExpr.html#ArithmeticExpr"><span class="hs-identifier hs-type">ArithmeticExpr</span></a></span><span>
</span><span id="line-386"></span><span id="arithmeticExprFromModuloExpr"><span class="annot"><span class="annottext">arithmeticExprFromModuloExpr :: ModuloExpr -&gt; ArithmeticExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#arithmeticExprFromModuloExpr"><span class="hs-identifier hs-var hs-var">arithmeticExprFromModuloExpr</span></a></span></span><span> </span><span id="local-6989586621680004649"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004649"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ArithmeticExpr
</span><a href="Jikka.Core.Language.ArithmeticExpr.html#parseArithmeticExpr"><span class="hs-identifier hs-var">parseArithmeticExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; ArithmeticExpr)
-&gt; (SumExpr -&gt; Expr) -&gt; SumExpr -&gt; ArithmeticExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-var">formatTopSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004649"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr -&gt; ArithmeticExpr) -&gt; SumExpr -&gt; ArithmeticExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621680004649"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-387"></span></pre></body></html>