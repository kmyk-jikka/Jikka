<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Jikka.Core.Language.ModuloExpr</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Basic functions</span></span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier">ModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseModuloExpr"><span class="hs-identifier">parseModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopModuloExpr"><span class="hs-identifier">formatTopModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomModuloExpr"><span class="hs-identifier">formatBottomModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier">integerModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateModuloExpr"><span class="hs-identifier">negateModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier">plusModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier">minusModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier">multModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isZeroModuloExpr"><span class="hs-identifier">isZeroModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isOneModuloExpr"><span class="hs-identifier">isOneModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloOfModuloExpr"><span class="hs-identifier">moduloOfModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#arithmeticExprFromModuloExpr"><span class="hs-identifier">arithmeticExprFromModuloExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier">formatModulo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-identifier">isModulo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Common.Error.html"><span class="hs-identifier">Jikka.Common.Error</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Format.html"><span class="hs-identifier">Jikka.Core.Format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Format.html#formatExpr"><span class="hs-identifier">formatExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ArithmeticExpr.html"><span class="hs-identifier">Jikka.Core.Language.ArithmeticExpr</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html"><span class="hs-identifier">Jikka.Core.Language.BuiltinPatterns</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html"><span class="hs-identifier">Jikka.Core.Language.Expr</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Runtime.html"><span class="hs-identifier">Jikka.Core.Language.Runtime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Runtime.html#modinv"><span class="hs-identifier">modinv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Runtime.html#modpow"><span class="hs-identifier">modpow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Util.html"><span class="hs-identifier">Jikka.Core.Language.Util</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | `Modulo` is just a newtype to avoid mistakes that swapping left and right of mod-op.</span><span>
</span><span id="line-37"></span><span class="hs-keyword">newtype</span><span> </span><span id="Modulo"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Modulo"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unModulo"><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679948589"><span id="local-6989586621679948591"><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
(Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool) -&gt; Eq Modulo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Modulo -&gt; Modulo -&gt; Bool
$c/= :: Modulo -&gt; Modulo -&gt; Bool
== :: Modulo -&gt; Modulo -&gt; Bool
$c== :: Modulo -&gt; Modulo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948573"><span id="local-6989586621679948575"><span id="local-6989586621679948577"><span id="local-6989586621679948579"><span id="local-6989586621679948581"><span id="local-6989586621679948583"><span id="local-6989586621679948585"><span class="annot"><span class="annottext">Eq Modulo
Eq Modulo
-&gt; (Modulo -&gt; Modulo -&gt; Ordering)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Bool)
-&gt; (Modulo -&gt; Modulo -&gt; Modulo)
-&gt; (Modulo -&gt; Modulo -&gt; Modulo)
-&gt; Ord Modulo
Modulo -&gt; Modulo -&gt; Bool
Modulo -&gt; Modulo -&gt; Ordering
Modulo -&gt; Modulo -&gt; Modulo
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Modulo -&gt; Modulo -&gt; Modulo
$cmin :: Modulo -&gt; Modulo -&gt; Modulo
max :: Modulo -&gt; Modulo -&gt; Modulo
$cmax :: Modulo -&gt; Modulo -&gt; Modulo
&gt;= :: Modulo -&gt; Modulo -&gt; Bool
$c&gt;= :: Modulo -&gt; Modulo -&gt; Bool
&gt; :: Modulo -&gt; Modulo -&gt; Bool
$c&gt; :: Modulo -&gt; Modulo -&gt; Bool
&lt;= :: Modulo -&gt; Modulo -&gt; Bool
$c&lt;= :: Modulo -&gt; Modulo -&gt; Bool
&lt; :: Modulo -&gt; Modulo -&gt; Bool
$c&lt; :: Modulo -&gt; Modulo -&gt; Bool
compare :: Modulo -&gt; Modulo -&gt; Ordering
$ccompare :: Modulo -&gt; Modulo -&gt; Ordering
$cp1Ord :: Eq Modulo
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948566"><span id="local-6989586621679948568"><span id="local-6989586621679948570"><span class="annot"><span class="annottext">Int -&gt; Modulo -&gt; ShowS
[Modulo] -&gt; ShowS
Modulo -&gt; String
(Int -&gt; Modulo -&gt; ShowS)
-&gt; (Modulo -&gt; String) -&gt; ([Modulo] -&gt; ShowS) -&gt; Show Modulo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Modulo] -&gt; ShowS
$cshowList :: [Modulo] -&gt; ShowS
show :: Modulo -&gt; String
$cshow :: Modulo -&gt; String
showsPrec :: Int -&gt; Modulo -&gt; ShowS
$cshowsPrec :: Int -&gt; Modulo -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948557"><span id="local-6989586621679948559"><span id="local-6989586621679948561"><span id="local-6989586621679948563"><span class="annot"><span class="annottext">ReadPrec [Modulo]
ReadPrec Modulo
Int -&gt; ReadS Modulo
ReadS [Modulo]
(Int -&gt; ReadS Modulo)
-&gt; ReadS [Modulo]
-&gt; ReadPrec Modulo
-&gt; ReadPrec [Modulo]
-&gt; Read Modulo
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Modulo]
$creadListPrec :: ReadPrec [Modulo]
readPrec :: ReadPrec Modulo
$creadPrec :: ReadPrec Modulo
readList :: ReadS [Modulo]
$creadList :: ReadS [Modulo]
readsPrec :: Int -&gt; ReadS Modulo
$creadsPrec :: Int -&gt; ReadS Modulo
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier hs-type">formatModulo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-41"></span><span id="formatModulo"><span class="annot"><span class="annottext">formatModulo :: Modulo -&gt; String
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier hs-var hs-var">formatModulo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.Core.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; String) -&gt; (Modulo -&gt; Expr) -&gt; Modulo -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-identifier hs-type">isModulo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-44"></span><span id="isModulo"><span class="annot"><span class="annottext">isModulo :: Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-identifier hs-var hs-var">isModulo</span></a></span></span><span> </span><span id="local-6989586621679948554"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948554"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span id="local-6989586621679948553"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948554"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-type">FloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948551"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948551"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948551"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948549"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948549"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948549"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-type">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948547"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948547"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948547"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-type">ModMinus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948545"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948545"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948545"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948543"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948543"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948543"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModInv%27"><span class="hs-identifier hs-type">ModInv'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948541"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948541"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948541"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-type">ModPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948539"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948539"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948539"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#VecFloorMod%27"><span class="hs-identifier hs-type">VecFloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948537"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948537"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948537"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#MatFloorMod%27"><span class="hs-identifier hs-type">MatFloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948535"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948535"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948535"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatAp%27"><span class="hs-identifier hs-type">ModMatAp'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948533"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948533"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948533"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatAdd%27"><span class="hs-identifier hs-type">ModMatAdd'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948531"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948531"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948531"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatMul%27"><span class="hs-identifier hs-type">ModMatMul'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948529"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948529"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948529"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMatPow%27"><span class="hs-identifier hs-type">ModMatPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948527"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948527"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948527"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModSum%27"><span class="hs-identifier hs-type">ModSum'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948525"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948525"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948525"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModProduct%27"><span class="hs-identifier hs-type">ModProduct'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948523"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948523"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948523"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948521"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948521"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948520"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948520"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948521"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948521"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948520"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Proj%27"><span class="hs-identifier hs-type">Proj'</span></a></span><span> </span><span id="local-6989586621679948515"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948515"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948514"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948514"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isVectorTy%27"><span class="hs-identifier hs-var">isVectorTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948515"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948514"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Proj%27"><span class="hs-identifier hs-type">Proj'</span></a></span><span> </span><span id="local-6989586621679948512"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948512"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948511"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948511"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isMatrixTy%27"><span class="hs-identifier hs-var">isMatrixTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948512"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948511"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Map%27"><span class="hs-identifier hs-type">Map'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948508"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948508"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948508"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948506"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948506"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948506"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679948505"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621679948505"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; (Expr, [Expr])
</span><a href="Jikka.Core.Language.Util.html#curryApp"><span class="hs-identifier hs-var">curryApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948505"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679948502"><span class="annot"><span class="annottext">e :: Expr
</span><a href="#local-6989586621679948502"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948502"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Tuple%27"><span class="hs-identifier hs-type">Tuple'</span></a></span><span> </span><span id="local-6989586621679948500"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948500"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948499"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948499"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isVectorTy%27"><span class="hs-identifier hs-var">isVectorTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948500"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; [Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948499"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Tuple%27"><span class="hs-identifier hs-type">Tuple'</span></a></span><span> </span><span id="local-6989586621679948497"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948497"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948496"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948496"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="Jikka.Core.Language.Util.html#isMatrixTy%27"><span class="hs-identifier hs-var">isMatrixTy'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679948497"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; [Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948553"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948496"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">(Expr, [Expr])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">data</span><span> </span><span id="ProductExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-var">ProductExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProductExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-var">ProductExpr</span></a></span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="productExprConst"><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span id="productExprList"><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span id="productExprInvList"><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679948488"><span id="local-6989586621679948490"><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Bool
(ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool) -&gt; Eq ProductExpr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c/= :: ProductExpr -&gt; ProductExpr -&gt; Bool
== :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c== :: ProductExpr -&gt; ProductExpr -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948473"><span id="local-6989586621679948475"><span id="local-6989586621679948477"><span id="local-6989586621679948479"><span id="local-6989586621679948481"><span id="local-6989586621679948483"><span id="local-6989586621679948485"><span class="annot"><span class="annottext">Eq ProductExpr
Eq ProductExpr
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Ordering)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; ProductExpr)
-&gt; (ProductExpr -&gt; ProductExpr -&gt; ProductExpr)
-&gt; Ord ProductExpr
ProductExpr -&gt; ProductExpr -&gt; Bool
ProductExpr -&gt; ProductExpr -&gt; Ordering
ProductExpr -&gt; ProductExpr -&gt; ProductExpr
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
$cmin :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
max :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
$cmax :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
&gt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&gt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
&gt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&gt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
&lt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&lt;= :: ProductExpr -&gt; ProductExpr -&gt; Bool
&lt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
$c&lt; :: ProductExpr -&gt; ProductExpr -&gt; Bool
compare :: ProductExpr -&gt; ProductExpr -&gt; Ordering
$ccompare :: ProductExpr -&gt; ProductExpr -&gt; Ordering
$cp1Ord :: Eq ProductExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948467"><span id="local-6989586621679948469"><span id="local-6989586621679948471"><span class="annot"><span class="annottext">Int -&gt; ProductExpr -&gt; ShowS
[ProductExpr] -&gt; ShowS
ProductExpr -&gt; String
(Int -&gt; ProductExpr -&gt; ShowS)
-&gt; (ProductExpr -&gt; String)
-&gt; ([ProductExpr] -&gt; ShowS)
-&gt; Show ProductExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProductExpr] -&gt; ShowS
$cshowList :: [ProductExpr] -&gt; ShowS
show :: ProductExpr -&gt; String
$cshow :: ProductExpr -&gt; String
showsPrec :: Int -&gt; ProductExpr -&gt; ShowS
$cshowsPrec :: Int -&gt; ProductExpr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948459"><span id="local-6989586621679948461"><span id="local-6989586621679948463"><span id="local-6989586621679948465"><span class="annot"><span class="annottext">ReadPrec [ProductExpr]
ReadPrec ProductExpr
Int -&gt; ReadS ProductExpr
ReadS [ProductExpr]
(Int -&gt; ReadS ProductExpr)
-&gt; ReadS [ProductExpr]
-&gt; ReadPrec ProductExpr
-&gt; ReadPrec [ProductExpr]
-&gt; Read ProductExpr
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [ProductExpr]
$creadListPrec :: ReadPrec [ProductExpr]
readPrec :: ReadPrec ProductExpr
$creadPrec :: ReadPrec ProductExpr
readList :: ReadS [ProductExpr]
$creadList :: ReadS [ProductExpr]
readsPrec :: Int -&gt; ReadS ProductExpr
$creadsPrec :: Int -&gt; ReadS ProductExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="SumExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-var">SumExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SumExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-var">SumExpr</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sumExprList"><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span id="sumExprConst"><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679948452"><span id="local-6989586621679948454"><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; Bool
(SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool) -&gt; Eq SumExpr
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SumExpr -&gt; SumExpr -&gt; Bool
$c/= :: SumExpr -&gt; SumExpr -&gt; Bool
== :: SumExpr -&gt; SumExpr -&gt; Bool
$c== :: SumExpr -&gt; SumExpr -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948437"><span id="local-6989586621679948439"><span id="local-6989586621679948441"><span id="local-6989586621679948443"><span id="local-6989586621679948445"><span id="local-6989586621679948447"><span id="local-6989586621679948449"><span class="annot"><span class="annottext">Eq SumExpr
Eq SumExpr
-&gt; (SumExpr -&gt; SumExpr -&gt; Ordering)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; Bool)
-&gt; (SumExpr -&gt; SumExpr -&gt; SumExpr)
-&gt; (SumExpr -&gt; SumExpr -&gt; SumExpr)
-&gt; Ord SumExpr
SumExpr -&gt; SumExpr -&gt; Bool
SumExpr -&gt; SumExpr -&gt; Ordering
SumExpr -&gt; SumExpr -&gt; SumExpr
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: SumExpr -&gt; SumExpr -&gt; SumExpr
$cmin :: SumExpr -&gt; SumExpr -&gt; SumExpr
max :: SumExpr -&gt; SumExpr -&gt; SumExpr
$cmax :: SumExpr -&gt; SumExpr -&gt; SumExpr
&gt;= :: SumExpr -&gt; SumExpr -&gt; Bool
$c&gt;= :: SumExpr -&gt; SumExpr -&gt; Bool
&gt; :: SumExpr -&gt; SumExpr -&gt; Bool
$c&gt; :: SumExpr -&gt; SumExpr -&gt; Bool
&lt;= :: SumExpr -&gt; SumExpr -&gt; Bool
$c&lt;= :: SumExpr -&gt; SumExpr -&gt; Bool
&lt; :: SumExpr -&gt; SumExpr -&gt; Bool
$c&lt; :: SumExpr -&gt; SumExpr -&gt; Bool
compare :: SumExpr -&gt; SumExpr -&gt; Ordering
$ccompare :: SumExpr -&gt; SumExpr -&gt; Ordering
$cp1Ord :: Eq SumExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948431"><span id="local-6989586621679948433"><span id="local-6989586621679948435"><span class="annot"><span class="annottext">Int -&gt; SumExpr -&gt; ShowS
[SumExpr] -&gt; ShowS
SumExpr -&gt; String
(Int -&gt; SumExpr -&gt; ShowS)
-&gt; (SumExpr -&gt; String) -&gt; ([SumExpr] -&gt; ShowS) -&gt; Show SumExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SumExpr] -&gt; ShowS
$cshowList :: [SumExpr] -&gt; ShowS
show :: SumExpr -&gt; String
$cshow :: SumExpr -&gt; String
showsPrec :: Int -&gt; SumExpr -&gt; ShowS
$cshowsPrec :: Int -&gt; SumExpr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948423"><span id="local-6989586621679948425"><span id="local-6989586621679948427"><span id="local-6989586621679948429"><span class="annot"><span class="annottext">ReadPrec [SumExpr]
ReadPrec SumExpr
Int -&gt; ReadS SumExpr
ReadS [SumExpr]
(Int -&gt; ReadS SumExpr)
-&gt; ReadS [SumExpr]
-&gt; ReadPrec SumExpr
-&gt; ReadPrec [SumExpr]
-&gt; Read SumExpr
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [SumExpr]
$creadListPrec :: ReadPrec [SumExpr]
readPrec :: ReadPrec SumExpr
$creadPrec :: ReadPrec SumExpr
readList :: ReadS [SumExpr]
$creadList :: ReadS [SumExpr]
readsPrec :: Int -&gt; ReadS SumExpr
$creadsPrec :: Int -&gt; ReadS SumExpr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">data</span><span> </span><span id="ModuloExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ModuloExpr"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="unModuloExpr"><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>    </span><span id="modulo"><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679948414"><span id="local-6989586621679948416"><span id="local-6989586621679948418"><span class="annot"><span class="annottext">Int -&gt; ModuloExpr -&gt; ShowS
[ModuloExpr] -&gt; ShowS
ModuloExpr -&gt; String
(Int -&gt; ModuloExpr -&gt; ShowS)
-&gt; (ModuloExpr -&gt; String)
-&gt; ([ModuloExpr] -&gt; ShowS)
-&gt; Show ModuloExpr
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ModuloExpr] -&gt; ShowS
$cshowList :: [ModuloExpr] -&gt; ShowS
show :: ModuloExpr -&gt; String
$cshow :: ModuloExpr -&gt; String
showsPrec :: Int -&gt; ModuloExpr -&gt; ShowS
$cshowsPrec :: Int -&gt; ModuloExpr -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679948411"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679948410"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948410"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948409"><span class="annot"><span class="annottext">== :: ModuloExpr -&gt; ModuloExpr -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679948408"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948408"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948410"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948408"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948410"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948408"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679948393"><span id="local-6989586621679948395"><span id="local-6989586621679948397"><span id="local-6989586621679948399"><span id="local-6989586621679948401"><span id="local-6989586621679948403"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679948392"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948392"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948391"><span class="annot"><span class="annottext">compare :: ModuloExpr -&gt; ModuloExpr -&gt; Ordering
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`compare`</span></span></span><span> </span><span id="local-6989586621679948389"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948389"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948392"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948392"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr, Modulo) -&gt; (SumExpr, Modulo) -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948389"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948389"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-type">negateProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-100"></span><span id="negateProductExpr"><span class="annot"><span class="annottext">negateProductExpr :: ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var hs-var">negateProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948387"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948387"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948387"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948387"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-type">multProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-103"></span><span id="multProductExpr"><span class="annot"><span class="annottext">multProductExpr :: ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var hs-var">multProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948385"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948385"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948384"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948384"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948385"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948384"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948385"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948384"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948385"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948384"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-type">powProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-111"></span><span id="powProductExpr"><span class="annot"><span class="annottext">powProductExpr :: Integer -&gt; ProductExpr -&gt; Integer -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-var hs-var">powProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948381"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948381"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948380"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948380"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679948379"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948379"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error Integer -&gt; Integer
forall a. Either Error a -&gt; a
</span><a href="Jikka.Common.Error.html#fromSuccess"><span class="hs-identifier hs-var">fromSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Error Integer -&gt; Integer)
-&gt; Either Error Integer -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Either Error Integer
forall (m :: * -&gt; *).
MonadError Error m =&gt;
Integer -&gt; Integer -&gt; Integer -&gt; m Integer
</span><a href="Jikka.Core.Language.Runtime.html#modpow"><span class="hs-identifier hs-var">modpow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948380"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948379"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948381"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679948377"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948377"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-var">ModPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948377"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948379"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948381"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948380"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679948376"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948376"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-var">ModPow'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948376"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948379"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948381"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948380"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="local-6989586621679948643"><span id="local-6989586621679948644"><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-type">partitionMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679948644"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679948643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679948644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679948643"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679948644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-119"></span><span id="partitionMaybe"><span class="annot"><span class="annottext">partitionMaybe :: (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-var hs-var">partitionMaybe</span></a></span></span><span> </span><span id="local-6989586621679948374"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679948374"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679948373"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679948373"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679948372"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679948372"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679948371"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679948371"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948370"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679948370"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-var">partitionMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679948374"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679948372"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-123"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679948374"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679948373"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-124"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679948369"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679948369"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679948369"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679948371"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679948370"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>          </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679948371"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679948373"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679948370"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-type">fromLitInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-128"></span><span id="fromLitInt"><span class="annot"><span class="annottext">fromLitInt :: Expr -&gt; Maybe Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-var hs-var">fromLitInt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948367"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948367"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948367"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-var">fromLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-type">invProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-132"></span><span id="invProductExpr"><span class="annot"><span class="annottext">invProductExpr :: Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-var hs-var">invProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948365"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948365"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948364"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948364"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679948363"><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679948363"><span class="hs-identifier hs-var">invKs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679948362"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948362"><span class="hs-identifier hs-var">invList</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Maybe Integer) -&gt; [Expr] -&gt; ([Integer], [Expr])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="Jikka.Core.Language.ModuloExpr.html#partitionMaybe"><span class="hs-identifier hs-var">partitionMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#fromLitInt"><span class="hs-identifier hs-var">fromLitInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948364"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621679948361"><span class="annot"><span class="annottext">e' :: ProductExpr
</span><a href="#local-6989586621679948361"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-136"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679948363"><span class="hs-identifier hs-var">invKs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>            </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948364"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Expr] -&gt; [Expr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948362"><span class="hs-identifier hs-var">invList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>            </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948364"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948365"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948359"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948359"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Either Error Integer
forall (m :: * -&gt; *).
MonadError Error m =&gt;
Integer -&gt; Integer -&gt; m Integer
</span><a href="Jikka.Core.Language.Runtime.html#modinv"><span class="hs-identifier hs-var">modinv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948364"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948359"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679948358"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948358"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-144"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948358"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">product</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621679948363"><span class="hs-identifier hs-var">invKs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948359"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>                </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948362"><span class="hs-identifier hs-var">invList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>                </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948364"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-147"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>          </span><span class="annot"><span class="annottext">Either Error Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948361"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948361"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-type">isInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-152"></span><span id="isInteger"><span class="annot"><span class="annottext">isInteger :: Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-var hs-var">isInteger</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-var">isInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-type">moduloToInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-156"></span><span id="moduloToInteger"><span class="annot"><span class="annottext">moduloToInteger :: Modulo -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-var hs-var">moduloToInteger</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948354"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948354"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948354"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-var">moduloToInteger</span></a></span><span> </span><span id="local-6989586621679948353"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948353"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Integer
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Integer) -&gt; String -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Jikka.Core.Language.ModuloExpr.moduloToInteger: modulo is not an integer&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; String
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatModulo"><span class="hs-identifier hs-var">formatModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948353"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-type">parseProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-160"></span><span id="parseProductExpr"><span class="annot"><span class="annottext">parseProductExpr :: Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var hs-var">parseProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948350"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948349"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948349"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948349"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Negate%27"><span class="hs-identifier hs-type">Negate'</span></a></span><span> </span><span id="local-6989586621679948347"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948347"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var">negateProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948347"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-type">Mult'</span></a></span><span> </span><span id="local-6989586621679948345"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948345"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948344"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948344"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948345"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948344"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#JustDiv%27"><span class="hs-identifier hs-type">JustDiv'</span></a></span><span> </span><span id="local-6989586621679948342"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948342"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948341"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948341"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948342"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-var">invProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948341"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Pow%27"><span class="hs-identifier hs-type">Pow'</span></a></span><span> </span><span id="local-6989586621679948339"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948339"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948338"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948338"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isInteger"><span class="hs-identifier hs-var">isInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ProductExpr -&gt; Integer -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-var">powProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#moduloToInteger"><span class="hs-identifier hs-var">moduloToInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948339"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948338"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span id="local-6989586621679948337"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948337"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679948336"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948336"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948336"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var">negateProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948337"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span id="local-6989586621679948335"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948335"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948334"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948334"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679948333"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948333"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948333"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948335"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948334"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPow%27"><span class="hs-identifier hs-type">ModPow'</span></a></span><span> </span><span id="local-6989586621679948332"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948332"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948331"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948331"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948330"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948330"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948330"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ProductExpr -&gt; Integer -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#powProductExpr"><span class="hs-identifier hs-var">powProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948330"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948332"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948331"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModInv%27"><span class="hs-identifier hs-type">ModInv'</span></a></span><span> </span><span id="local-6989586621679948329"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948329"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948328"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948328"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948328"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#invProductExpr"><span class="hs-identifier hs-var">invProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948350"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948329"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679948327"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948327"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948327"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#sumExprFromProductExpr"><span class="hs-identifier hs-type">sumExprFromProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-173"></span><span id="sumExprFromProductExpr"><span class="annot"><span class="annottext">sumExprFromProductExpr :: ProductExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprFromProductExpr"><span class="hs-identifier hs-var hs-var">sumExprFromProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948325"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948325"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948325"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#integerSumExpr"><span class="hs-identifier hs-type">integerSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-180"></span><span id="integerSumExpr"><span class="annot"><span class="annottext">integerSumExpr :: Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerSumExpr"><span class="hs-identifier hs-var hs-var">integerSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948323"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948323"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948323"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-type">integerModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-187"></span><span id="integerModuloExpr"><span class="annot"><span class="annottext">integerModuloExpr :: Modulo -&gt; Integer -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-var hs-var">integerModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948322"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948322"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948321"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948321"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerSumExpr"><span class="hs-identifier hs-var">integerSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948321"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948322"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-type">negateSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-190"></span><span id="negateSumExpr"><span class="annot"><span class="annottext">negateSumExpr :: SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var hs-var">negateSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948319"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948319"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateProductExpr"><span class="hs-identifier hs-var">negateProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948319"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948319"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-type">plusSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-197"></span><span id="plusSumExpr"><span class="annot"><span class="annottext">plusSumExpr :: SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var hs-var">plusSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948317"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948317"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948316"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948316"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948317"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr] -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948316"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948317"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948316"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-type">multSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-204"></span><span id="multSumExpr"><span class="annot"><span class="annottext">multSumExpr :: Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var hs-var">multSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948313"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948313"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948312"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948312"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948311"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948311"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679948310"><span class="annot"><span class="annottext">es1 :: [ProductExpr]
</span><a href="#local-6989586621679948310"><span class="hs-identifier hs-var hs-var">es1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948313"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948312"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948312"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span id="local-6989586621679948309"><span class="annot"><span class="annottext">es2 :: [ProductExpr]
</span><a href="#local-6989586621679948309"><span class="hs-identifier hs-var hs-var">es2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948313"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948311"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948311"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-209"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[ProductExpr] -&gt; [ProductExpr]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([ProductExpr] -&gt; [ProductExpr]) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ProductExpr, ProductExpr) -&gt; ProductExpr)
-&gt; [(ProductExpr, ProductExpr)] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; ProductExpr)
-&gt; (ProductExpr, ProductExpr) -&gt; ProductExpr
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multProductExpr"><span class="hs-identifier hs-var">multProductExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; (ProductExpr, ProductExpr))
-&gt; [ProductExpr] -&gt; [ProductExpr -&gt; (ProductExpr, ProductExpr)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948310"><span class="hs-identifier hs-var">es1</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr -&gt; (ProductExpr, ProductExpr)]
-&gt; [ProductExpr] -&gt; [(ProductExpr, ProductExpr)]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948309"><span class="hs-identifier hs-var">es2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948312"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948311"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#negateModuloExpr"><span class="hs-identifier hs-type">negateModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-214"></span><span id="negateModuloExpr"><span class="annot"><span class="annottext">negateModuloExpr :: ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateModuloExpr"><span class="hs-identifier hs-var hs-var">negateModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621679948305"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948305"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679948304"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948304"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948305"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948304"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier hs-type">plusModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-217"></span><span id="plusModuloExpr"><span class="annot"><span class="annottext">plusModuloExpr :: ModuloExpr -&gt; ModuloExpr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier hs-var hs-var">plusModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621679948303"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948303"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948302"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948302"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621679948301"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948301"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679948300"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948300"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948302"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948300"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948303"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948301"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948302"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#plusModuloExpr"><span class="hs-identifier hs-var">plusModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuloExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier hs-type">minusModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-221"></span><span id="minusModuloExpr"><span class="annot"><span class="annottext">minusModuloExpr :: ModuloExpr -&gt; ModuloExpr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier hs-var hs-var">minusModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621679948299"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948299"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948298"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948298"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621679948297"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948297"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679948296"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948296"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948298"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948296"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948299"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948297"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948298"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#minusModuloExpr"><span class="hs-identifier hs-var">minusModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuloExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier hs-type">multModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-225"></span><span id="multModuloExpr"><span class="annot"><span class="annottext">multModuloExpr :: ModuloExpr -&gt; ModuloExpr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier hs-var hs-var">multModuloExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621679948295"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948295"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948294"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948294"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span id="local-6989586621679948293"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948293"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679948292"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948292"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948294"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948292"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var">multSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948294"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948295"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948293"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948294"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#multModuloExpr"><span class="hs-identifier hs-var">multModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuloExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-type">parseSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-229"></span><span id="parseSumExpr"><span class="annot"><span class="annottext">parseSumExpr :: Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var hs-var">parseSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948290"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948289"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948289"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948289"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Negate%27"><span class="hs-identifier hs-type">Negate'</span></a></span><span> </span><span id="local-6989586621679948288"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948288"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948288"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Plus%27"><span class="hs-identifier hs-type">Plus'</span></a></span><span> </span><span id="local-6989586621679948286"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948286"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948285"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948285"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948286"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948285"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Minus%27"><span class="hs-identifier hs-type">Minus'</span></a></span><span> </span><span id="local-6989586621679948283"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948283"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948282"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948282"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948283"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948282"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-type">Mult'</span></a></span><span> </span><span id="local-6989586621679948281"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948281"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948280"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948280"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var">multSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948281"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948280"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-type">FloorMod'</span></a></span><span> </span><span id="local-6989586621679948279"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948279"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679948278"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948278"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948278"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948279"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span id="local-6989586621679948277"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948277"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679948276"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948276"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948276"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948277"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-type">ModPlus'</span></a></span><span> </span><span id="local-6989586621679948275"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948275"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948274"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948274"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679948273"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948273"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948273"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948275"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948274"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-type">ModMinus'</span></a></span><span> </span><span id="local-6989586621679948272"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948272"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948271"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948271"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679948270"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948270"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948270"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#plusSumExpr"><span class="hs-identifier hs-var">plusSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948272"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#negateSumExpr"><span class="hs-identifier hs-var">negateSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948271"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span id="local-6989586621679948269"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948269"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948268"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948268"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679948267"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948267"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948267"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Modulo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#multSumExpr"><span class="hs-identifier hs-var">multSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948269"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948268"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679948266"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948266"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprFromProductExpr"><span class="hs-identifier hs-var">sumExprFromProductExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseProductExpr"><span class="hs-identifier hs-var">parseProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948290"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948266"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#getModuloFromExpr"><span class="hs-identifier hs-type">getModuloFromExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span>
</span><span id="line-243"></span><span id="getModuloFromExpr"><span class="annot"><span class="annottext">getModuloFromExpr :: Expr -&gt; Maybe Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#getModuloFromExpr"><span class="hs-identifier hs-var hs-var">getModuloFromExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-type">FloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948264"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948264"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948264"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-type">ModNegate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948263"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948263"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948263"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-type">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948262"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948262"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948262"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-type">ModMinus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948261"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948261"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948261"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-type">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679948260"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948260"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Maybe Modulo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Maybe Modulo) -&gt; Modulo -&gt; Maybe Modulo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-var">Modulo</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948260"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Modulo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | `parseModuloExpr` converts a given expr to a normal form \(\sum_i \prod_j e _ {i,j}) \bmod m\).</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- This assumes given exprs have the type \(\mathbf{int}\).</span><span>
</span><span id="line-253"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#parseModuloExpr"><span class="hs-identifier hs-type">parseModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-254"></span><span id="parseModuloExpr"><span class="annot"><span class="annottext">parseModuloExpr :: Expr -&gt; Maybe ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseModuloExpr"><span class="hs-identifier hs-var hs-var">parseModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948259"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948259"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679948258"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948258"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#getModuloFromExpr"><span class="hs-identifier hs-var">getModuloFromExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948259"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Maybe ModuloExpr
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Maybe ModuloExpr) -&gt; ModuloExpr -&gt; Maybe ModuloExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#parseSumExpr"><span class="hs-identifier hs-var">parseSumExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948258"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948259"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948258"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-type">formatTopProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-259"></span><span id="formatTopProductExpr"><span class="annot"><span class="annottext">formatTopProductExpr :: Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-var hs-var">formatTopProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948256"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948256"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948255"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948255"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679948254"><span class="annot"><span class="annottext">k :: Expr
</span><a href="#local-6989586621679948254"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948255"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>      </span><span id="local-6989586621679948253"><span class="annot"><span class="annottext">k' :: Expr -&gt; Expr
</span><a href="#local-6989586621679948253"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621679948252"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948252"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948255"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948252"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Negate%27"><span class="hs-identifier hs-var">Negate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948252"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-var">Mult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948252"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948254"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621679948251"><span class="annot"><span class="annottext">invList :: [Expr]
</span><a href="#local-6989586621679948251"><span class="hs-identifier hs-var hs-var">invList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-operator hs-var">`FloorMod'`</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948256"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948255"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948255"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948251"><span class="hs-identifier hs-var">invList</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948254"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span id="local-6989586621679948250"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948250"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679948249"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948249"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621679948253"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; Expr -&gt; Expr) -&gt; Expr -&gt; [Expr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Mult%27"><span class="hs-identifier hs-var">Mult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948250"><span class="hs-identifier hs-var">eHead</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948249"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-type">formatTopSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-272"></span><span id="formatTopSumExpr"><span class="annot"><span class="annottext">formatTopSumExpr :: Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-var hs-var">formatTopSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948246"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948246"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948245"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948245"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948245"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948245"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679948244"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948244"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679948243"><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948243"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679948242"><span class="annot"><span class="annottext">op :: ProductExpr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621679948242"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679948241"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948241"><span class="hs-identifier hs-var">e'</span></a></span></span><span>
</span><span id="line-276"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948241"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Plus%27"><span class="hs-identifier hs-var">Plus'</span></a></span><span>
</span><span id="line-277"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948241"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Minus%27"><span class="hs-identifier hs-var">Minus'</span></a></span><span>
</span><span id="line-278"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-279"></span><span>        </span><span id="local-6989586621679948238"><span class="annot"><span class="annottext">go :: Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621679948238"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679948237"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948237"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948236"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948236"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="#local-6989586621679948242"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948236"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948237"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-var">formatTopProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948246"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948236"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948236"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>        </span><span id="local-6989586621679948234"><span class="annot"><span class="annottext">k' :: Expr -&gt; Expr
</span><a href="#local-6989586621679948234"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621679948233"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948233"><span class="hs-identifier hs-var">e'</span></a></span></span><span>
</span><span id="line-281"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948245"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Plus%27"><span class="hs-identifier hs-var">Plus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948233"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948245"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948245"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#Minus%27"><span class="hs-identifier hs-var">Minus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948233"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948245"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948233"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-284"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621679948234"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; ProductExpr -&gt; Expr) -&gt; Expr -&gt; [ProductExpr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621679948238"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopProductExpr"><span class="hs-identifier hs-var">formatTopProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948246"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948244"><span class="hs-identifier hs-var">eHead</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948243"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | `formatTopModuloExpr` convert `ModuloExpr` to `Expr` with adding `FloorMod` at only the root.</span><span>
</span><span id="line-287"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatTopModuloExpr"><span class="hs-identifier hs-type">formatTopModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-288"></span><span id="formatTopModuloExpr"><span class="annot"><span class="annottext">formatTopModuloExpr :: ModuloExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopModuloExpr"><span class="hs-identifier hs-var hs-var">formatTopModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948232"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948232"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-var">FloorMod'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-var">formatTopSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948232"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr -&gt; Expr) -&gt; (ModuloExpr -&gt; SumExpr) -&gt; ModuloExpr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Expr) -&gt; ModuloExpr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948232"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Expr) -&gt; Modulo -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948232"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-type">formatBottomInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-291"></span><span id="formatBottomInteger"><span class="annot"><span class="annottext">formatBottomInteger :: Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var hs-var">formatBottomInteger</span></a></span></span><span> </span><span id="local-6989586621679948230"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948230"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948229"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948229"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948230"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948228"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948228"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948229"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948228"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679948227"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948227"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-var">FloorMod'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948229"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948227"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-type">formatBottomProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-296"></span><span id="formatBottomProductExpr"><span class="annot"><span class="annottext">formatBottomProductExpr :: Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var hs-var">formatBottomProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948225"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948224"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948224"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679948223"><span class="annot"><span class="annottext">k :: Expr
</span><a href="#local-6989586621679948223"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var">formatBottomInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948224"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>      </span><span id="local-6989586621679948222"><span class="annot"><span class="annottext">k' :: Expr -&gt; Expr
</span><a href="#local-6989586621679948222"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621679948221"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948221"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948224"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr
</span><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-var">LitInt'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948221"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModNegate%27"><span class="hs-identifier hs-var">ModNegate'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948221"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-var">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948221"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948223"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621679948220"><span class="annot"><span class="annottext">invList :: [Expr]
</span><a href="#local-6989586621679948220"><span class="hs-identifier hs-var hs-var">invList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModInv%27"><span class="hs-operator hs-var">`ModInv'`</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948224"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>      </span><span id="local-6989586621679948219"><span class="annot"><span class="annottext">list :: [Expr]
</span><a href="#local-6989586621679948219"><span class="hs-identifier hs-var hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; [Expr] -&gt; [Expr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679948218"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948218"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948218"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Modulo -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isModulo"><span class="hs-operator hs-var">`isModulo`</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948218"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#FloorMod%27"><span class="hs-identifier hs-var">FloorMod'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948218"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948224"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948219"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr] -&gt; [Expr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948220"><span class="hs-identifier hs-var">invList</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948223"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-307"></span><span>        </span><span id="local-6989586621679948217"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948217"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679948216"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948216"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621679948222"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; Expr -&gt; Expr) -&gt; Expr -&gt; [Expr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679948215"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948215"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948214"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948214"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMult%27"><span class="hs-identifier hs-var">ModMult'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948215"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948214"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948225"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948217"><span class="hs-identifier hs-var">eHead</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948216"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomSumExpr"><span class="hs-identifier hs-type">formatBottomSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-310"></span><span id="formatBottomSumExpr"><span class="annot"><span class="annottext">formatBottomSumExpr :: Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomSumExpr"><span class="hs-identifier hs-var hs-var">formatBottomSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948212"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948211"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948211"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948211"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var">formatBottomInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948211"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679948210"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948210"><span class="hs-identifier hs-var">eHead</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679948209"><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948209"><span class="hs-identifier hs-var">esTail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679948208"><span class="annot"><span class="annottext">go :: Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621679948208"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679948207"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948207"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948206"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948206"><span class="hs-identifier hs-var">e2</span></a></span></span><span>
</span><span id="line-314"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948206"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948207"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-315"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948206"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModMinus%27"><span class="hs-identifier hs-var">ModMinus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948207"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var">formatBottomProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948206"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-var">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948207"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var">formatBottomProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948206"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621679948205"><span class="annot"><span class="annottext">plusConst :: Expr -&gt; Expr
</span><a href="#local-6989586621679948205"><span class="hs-identifier hs-var hs-var">plusConst</span></a></span></span><span> </span><span id="local-6989586621679948204"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948204"><span class="hs-identifier hs-var">e'</span></a></span></span><span>
</span><span id="line-318"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948211"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948204"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-319"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr -&gt; Expr
</span><a href="Jikka.Core.Language.BuiltinPatterns.html#ModPlus%27"><span class="hs-identifier hs-var">ModPlus'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679948204"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomInteger"><span class="hs-identifier hs-var">formatBottomInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948211"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="#local-6989586621679948205"><span class="hs-identifier hs-var">plusConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; ProductExpr -&gt; Expr) -&gt; Expr -&gt; [ProductExpr] -&gt; Expr
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ProductExpr -&gt; Expr
</span><a href="#local-6989586621679948208"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomProductExpr"><span class="hs-identifier hs-var">formatBottomProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948212"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948210"><span class="hs-identifier hs-var">eHead</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948209"><span class="hs-identifier hs-var">esTail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | `formatBottomModuloExpr` convert `ModuloExpr` to `Expr` with adding `FloorMod` at every nodes.</span><span>
</span><span id="line-323"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomModuloExpr"><span class="hs-identifier hs-type">formatBottomModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-324"></span><span id="formatBottomModuloExpr"><span class="annot"><span class="annottext">formatBottomModuloExpr :: ModuloExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomModuloExpr"><span class="hs-identifier hs-var hs-var">formatBottomModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948203"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948203"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatBottomSumExpr"><span class="hs-identifier hs-var">formatBottomSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948203"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr -&gt; Expr) -&gt; (ModuloExpr -&gt; SumExpr) -&gt; ModuloExpr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuloExpr -&gt; Expr) -&gt; ModuloExpr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948203"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#normalizeProductExpr"><span class="hs-identifier hs-type">normalizeProductExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-327"></span><span id="normalizeProductExpr"><span class="annot"><span class="annottext">normalizeProductExpr :: Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeProductExpr"><span class="hs-identifier hs-var hs-var">normalizeProductExpr</span></a></span></span><span> </span><span id="local-6989586621679948201"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948201"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948200"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948200"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679948199"><span class="annot"><span class="annottext">k :: Integer
</span><a href="#local-6989586621679948199"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948201"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948198"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948198"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948200"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948198"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948200"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span id="local-6989586621679948197"><span class="annot"><span class="annottext">es :: [Expr]
</span><a href="#local-6989586621679948197"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948199"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-333"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-334"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948200"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>      </span><span id="local-6989586621679948195"><span class="annot"><span class="annottext">es' :: [Expr]
</span><a href="#local-6989586621679948195"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948199"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-337"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [Expr]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948200"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948200"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948197"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>          </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679948195"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>          </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948199"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#normalizeSumExpr"><span class="hs-identifier hs-type">normalizeSumExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-346"></span><span id="normalizeSumExpr"><span class="annot"><span class="annottext">normalizeSumExpr :: Modulo -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeSumExpr"><span class="hs-identifier hs-var hs-var">normalizeSumExpr</span></a></span></span><span> </span><span id="local-6989586621679948193"><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948193"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679948192"><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948192"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679948191"><span class="annot"><span class="annottext">f :: ProductExpr -&gt; ([Expr], [Expr])
</span><a href="#local-6989586621679948191"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679948190"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948190"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948190"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948190"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>      </span><span id="local-6989586621679948189"><span class="annot"><span class="annottext">cmp :: ProductExpr -&gt; ProductExpr -&gt; Ordering
</span><a href="#local-6989586621679948189"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621679948188"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948188"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948187"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948187"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ([Expr], [Expr])
</span><a href="#local-6989586621679948191"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948188"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">([Expr], [Expr]) -&gt; ([Expr], [Expr]) -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ([Expr], [Expr])
</span><a href="#local-6989586621679948191"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948187"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-349"></span><span>      </span><span id="local-6989586621679948186"><span class="annot"><span class="annottext">cmp' :: ProductExpr -&gt; ProductExpr -&gt; Bool
</span><a href="#local-6989586621679948186"><span class="hs-identifier hs-var hs-var">cmp'</span></a></span></span><span> </span><span id="local-6989586621679948185"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948185"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679948184"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948184"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Ordering
</span><a href="#local-6989586621679948189"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948185"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948184"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-350"></span><span>      </span><span id="local-6989586621679948183"><span class="annot"><span class="annottext">es :: [ProductExpr]
</span><a href="#local-6989586621679948183"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; Ordering)
-&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Ordering
</span><a href="#local-6989586621679948189"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; ProductExpr -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeProductExpr"><span class="hs-identifier hs-var">normalizeProductExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948193"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumExpr -&gt; [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var hs-var">sumExprList</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948192"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>      </span><span id="local-6989586621679948181"><span class="annot"><span class="annottext">es' :: [[ProductExpr]]
</span><a href="#local-6989586621679948181"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; ProductExpr -&gt; Bool)
-&gt; [ProductExpr] -&gt; [[ProductExpr]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">groupBy</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; ProductExpr -&gt; Bool
</span><a href="#local-6989586621679948186"><span class="hs-identifier hs-var">cmp'</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948183"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span id="local-6989586621679948179"><span class="annot"><span class="annottext">es'' :: [ProductExpr]
</span><a href="#local-6989586621679948179"><span class="hs-identifier hs-var hs-var">es''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">([ProductExpr] -&gt; ProductExpr) -&gt; [[ProductExpr]] -&gt; [ProductExpr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-354"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679948178"><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948178"><span class="hs-identifier hs-var">group</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>              </span><span class="annot"><span class="annottext">ProductExpr :: Integer -&gt; [Expr] -&gt; [Expr] -&gt; ProductExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ProductExpr"><span class="hs-identifier hs-type">ProductExpr</span></a></span><span>
</span><span id="line-356"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">productExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var">productExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; Integer) -&gt; [ProductExpr] -&gt; [Integer]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948178"><span class="hs-identifier hs-var">group</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-357"></span><span>                  </span><span class="annot"><span class="annottext">productExprList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var">productExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProductExpr] -&gt; ProductExpr
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948178"><span class="hs-identifier hs-var">group</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-358"></span><span>                  </span><span class="annot"><span class="annottext">productExprInvList :: [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var">productExprInvList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprInvList"><span class="hs-identifier hs-var hs-var">productExprInvList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProductExpr] -&gt; ProductExpr
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948178"><span class="hs-identifier hs-var">group</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-360"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>          </span><span class="annot"><span class="annottext">[[ProductExpr]]
</span><a href="#local-6989586621679948181"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-362"></span><span>      </span><span id="local-6989586621679948175"><span class="annot"><span class="annottext">es''' :: [ProductExpr]
</span><a href="#local-6989586621679948175"><span class="hs-identifier hs-var hs-var">es'''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductExpr -&gt; Bool) -&gt; [ProductExpr] -&gt; [ProductExpr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679948174"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948174"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948174"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948174"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948179"><span class="hs-identifier hs-var">es''</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span id="local-6989586621679948170"><span class="annot"><span class="annottext">k :: Integer
</span><a href="#local-6989586621679948170"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductExpr -&gt; Integer) -&gt; [ProductExpr] -&gt; [Integer]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679948169"><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948169"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductExpr -&gt; [Expr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprList"><span class="hs-identifier hs-var hs-var">productExprList</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948169"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ProductExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#productExprConst"><span class="hs-identifier hs-var hs-var">productExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">ProductExpr
</span><a href="#local-6989586621679948169"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948179"><span class="hs-identifier hs-var">es''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>      </span><span id="local-6989586621679948168"><span class="annot"><span class="annottext">k' :: Integer
</span><a href="#local-6989586621679948168"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var hs-var">sumExprConst</span></a></span><span> </span><span class="annot"><span class="annottext">SumExpr
</span><a href="#local-6989586621679948192"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948170"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621679948167"><span class="annot"><span class="annottext">k'' :: Integer
</span><a href="#local-6989586621679948167"><span class="hs-identifier hs-var hs-var">k''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modulo
</span><a href="#local-6989586621679948193"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#Modulo"><span class="hs-identifier hs-type">Modulo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.Core.Language.Expr.html#LitInt%27"><span class="hs-identifier hs-type">LitInt'</span></a></span><span> </span><span id="local-6989586621679948166"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948166"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948168"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948166"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="annottext">Modulo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948168"><span class="hs-identifier hs-var">k'</span></a></span><span>
</span><span id="line-368"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SumExpr :: [ProductExpr] -&gt; Integer -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#SumExpr"><span class="hs-identifier hs-type">SumExpr</span></a></span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sumExprList :: [ProductExpr]
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprList"><span class="hs-identifier hs-var">sumExprList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ProductExpr]
</span><a href="#local-6989586621679948175"><span class="hs-identifier hs-var">es'''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><span class="annottext">sumExprConst :: Integer
</span><a href="Jikka.Core.Language.ModuloExpr.html#sumExprConst"><span class="hs-identifier hs-var">sumExprConst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679948167"><span class="hs-identifier hs-var">k''</span></a></span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-type">normalizeModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span>
</span><span id="line-374"></span><span id="normalizeModuloExpr"><span class="annot"><span class="annottext">normalizeModuloExpr :: ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var hs-var">normalizeModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948165"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948165"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumExpr -&gt; Modulo -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-var">ModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeSumExpr"><span class="hs-identifier hs-var">normalizeSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948165"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948165"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948165"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isZeroModuloExpr"><span class="hs-identifier hs-type">isZeroModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-377"></span><span id="isZeroModuloExpr"><span class="annot"><span class="annottext">isZeroModuloExpr :: ModuloExpr -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isZeroModuloExpr"><span class="hs-identifier hs-var hs-var">isZeroModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948164"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948164"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948164"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-var">integerModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948164"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#isOneModuloExpr"><span class="hs-identifier hs-type">isOneModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-380"></span><span id="isOneModuloExpr"><span class="annot"><span class="annottext">isOneModuloExpr :: ModuloExpr -&gt; Bool
</span><a href="Jikka.Core.Language.ModuloExpr.html#isOneModuloExpr"><span class="hs-identifier hs-var hs-var">isOneModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948163"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948163"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#normalizeModuloExpr"><span class="hs-identifier hs-var">normalizeModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948163"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; ModuloExpr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Integer -&gt; ModuloExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#integerModuloExpr"><span class="hs-identifier hs-var">integerModuloExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948163"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#moduloOfModuloExpr"><span class="hs-identifier hs-type">moduloOfModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-383"></span><span id="moduloOfModuloExpr"><span class="annot"><span class="annottext">moduloOfModuloExpr :: ModuloExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#moduloOfModuloExpr"><span class="hs-identifier hs-var hs-var">moduloOfModuloExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModulo"><span class="hs-identifier hs-var hs-var">unModulo</span></a></span><span> </span><span class="annot"><span class="annottext">(Modulo -&gt; Expr) -&gt; (ModuloExpr -&gt; Modulo) -&gt; ModuloExpr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#arithmeticExprFromModuloExpr"><span class="hs-identifier hs-type">arithmeticExprFromModuloExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ModuloExpr.html#ModuloExpr"><span class="hs-identifier hs-type">ModuloExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Jikka.Core.Language.ArithmeticExpr.html#ArithmeticExpr"><span class="hs-identifier hs-type">ArithmeticExpr</span></a></span><span>
</span><span id="line-386"></span><span id="arithmeticExprFromModuloExpr"><span class="annot"><span class="annottext">arithmeticExprFromModuloExpr :: ModuloExpr -&gt; ArithmeticExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#arithmeticExprFromModuloExpr"><span class="hs-identifier hs-var hs-var">arithmeticExprFromModuloExpr</span></a></span></span><span> </span><span id="local-6989586621679948162"><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948162"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; ArithmeticExpr
</span><a href="Jikka.Core.Language.ArithmeticExpr.html#parseArithmeticExpr"><span class="hs-identifier hs-var">parseArithmeticExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; ArithmeticExpr)
-&gt; (SumExpr -&gt; Expr) -&gt; SumExpr -&gt; ArithmeticExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Modulo -&gt; SumExpr -&gt; Expr
</span><a href="Jikka.Core.Language.ModuloExpr.html#formatTopSumExpr"><span class="hs-identifier hs-var">formatTopSumExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuloExpr -&gt; Modulo
</span><a href="Jikka.Core.Language.ModuloExpr.html#modulo"><span class="hs-identifier hs-var hs-var">modulo</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948162"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SumExpr -&gt; ArithmeticExpr) -&gt; SumExpr -&gt; ArithmeticExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuloExpr -&gt; SumExpr
</span><a href="Jikka.Core.Language.ModuloExpr.html#unModuloExpr"><span class="hs-identifier hs-var hs-var">unModuloExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuloExpr
</span><a href="#local-6989586621679948162"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-387"></span></pre></body></html>