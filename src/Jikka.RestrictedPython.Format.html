<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      : Jikka.RestrictedPython.Format</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Description : converts the AST of the restricted Python to strings.</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   : (c) Kimiyuki Onaka, 2020</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     : Apache License 2.0</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  : kimiyuki95@gmail.com</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability : portable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- TODO: add parens with considering precedences.</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Jikka.RestrictedPython.Format</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#run"><span class="hs-identifier">run</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#run%27"><span class="hs-identifier">run'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.Common.Format.AutoIndent.html"><span class="hs-identifier">Jikka.Common.Format.AutoIndent</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html"><span class="hs-identifier">Jikka.RestrictedPython.Language.Expr</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-type">formatType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-25"></span><span id="formatType"><span class="annot"><span class="annottext">formatType :: Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var hs-var">formatType</span></a></span></span><span> </span><span id="local-6989586621679297550"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297550"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297550"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#VarTy"><span class="hs-identifier hs-type">VarTy</span></a></span><span> </span><span id="local-6989586621679297548"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679297548"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; String
</span><a href="Jikka.RestrictedPython.Language.Expr.html#unTypeName"><span class="hs-identifier hs-var">unTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621679297548"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Jikka.RestrictedPython.Language.Expr.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;int&quot;</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="Jikka.RestrictedPython.Language.Expr.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bool&quot;</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span> </span><span id="local-6989586621679297543"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297543"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297543"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#TupleTy"><span class="hs-identifier hs-type">TupleTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;None&quot;</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#TupleTy"><span class="hs-identifier hs-type">TupleTy</span></a></span><span> </span><span id="local-6989586621679297541"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679297541"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Tuple[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; String) -&gt; [Type] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679297541"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#CallableTy"><span class="hs-identifier hs-type">CallableTy</span></a></span><span> </span><span id="local-6989586621679297539"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679297539"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679297538"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297538"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Callable[[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; String) -&gt; [Type] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679297539"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;], &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297538"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatConstant"><span class="hs-identifier hs-type">formatConstant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-35"></span><span id="formatConstant"><span class="annot"><span class="annottext">formatConstant :: Constant -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatConstant"><span class="hs-identifier hs-var hs-var">formatConstant</span></a></span></span><span> </span><span class="annot"><span class="annottext">Constant
</span><a href="Jikka.RestrictedPython.Language.Expr.html#ConstNone"><span class="hs-identifier hs-var">ConstNone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;None&quot;</span></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatConstant"><span class="hs-identifier hs-var">formatConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span> </span><span id="local-6989586621679297534"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679297534"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679297534"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-37"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatConstant"><span class="hs-identifier hs-var">formatConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ConstBool"><span class="hs-identifier hs-type">ConstBool</span></a></span><span> </span><span id="local-6989586621679297531"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679297531"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679297531"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatBoolOp"><span class="hs-identifier hs-type">formatBoolOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Python.Language.Expr.html#BoolOp"><span class="hs-identifier hs-type">BoolOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-40"></span><span id="formatBoolOp"><span class="annot"><span class="annottext">formatBoolOp :: BoolOp -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatBoolOp"><span class="hs-identifier hs-var hs-var">formatBoolOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="annottext">BoolOp
</span><a href="Jikka.Python.Language.Expr.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;and&quot;</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="annottext">BoolOp
</span><a href="Jikka.Python.Language.Expr.html#Or"><span class="hs-identifier hs-var">Or</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;or&quot;</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="annottext">BoolOp
</span><a href="Jikka.Python.Language.Expr.html#Implies"><span class="hs-identifier hs-var">Implies</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;implies&quot;</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatOperator"><span class="hs-identifier hs-type">formatOperator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Python.Language.Expr.html#Operator"><span class="hs-identifier hs-type">Operator</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-46"></span><span id="formatOperator"><span class="annot"><span class="annottext">formatOperator :: Operator -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatOperator"><span class="hs-identifier hs-var hs-var">formatOperator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#Sub"><span class="hs-identifier hs-var">Sub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#Mult"><span class="hs-identifier hs-var">Mult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#MatMult"><span class="hs-identifier hs-var">MatMult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#Div"><span class="hs-identifier hs-var">Div</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#FloorDiv"><span class="hs-identifier hs-var">FloorDiv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;//&quot;</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#FloorMod"><span class="hs-identifier hs-var">FloorMod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%&quot;</span></span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#CeilDiv"><span class="hs-identifier hs-var">CeilDiv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/^&quot;</span></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#CeilMod"><span class="hs-identifier hs-var">CeilMod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%^&quot;</span></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#Pow"><span class="hs-identifier hs-var">Pow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;**&quot;</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#BitLShift"><span class="hs-identifier hs-var">BitLShift</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&lt;&quot;</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#BitRShift"><span class="hs-identifier hs-var">BitRShift</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&gt;&quot;</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#BitOr"><span class="hs-identifier hs-var">BitOr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#BitXor"><span class="hs-identifier hs-var">BitXor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^&quot;</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#BitAnd"><span class="hs-identifier hs-var">BitAnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;?&quot;</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="annottext">Operator
</span><a href="Jikka.Python.Language.Expr.html#Min"><span class="hs-identifier hs-var">Min</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;?&quot;</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatUnaryOp"><span class="hs-identifier hs-type">formatUnaryOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Python.Language.Expr.html#UnaryOp"><span class="hs-identifier hs-type">UnaryOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-66"></span><span id="formatUnaryOp"><span class="annot"><span class="annottext">formatUnaryOp :: UnaryOp -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatUnaryOp"><span class="hs-identifier hs-var hs-var">formatUnaryOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">UnaryOp
</span><a href="Jikka.Python.Language.Expr.html#Invert"><span class="hs-identifier hs-var">Invert</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~&quot;</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="annottext">UnaryOp
</span><a href="Jikka.Python.Language.Expr.html#Not"><span class="hs-identifier hs-var">Not</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not&quot;</span></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="annottext">UnaryOp
</span><a href="Jikka.Python.Language.Expr.html#UAdd"><span class="hs-identifier hs-var">UAdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="annottext">UnaryOp
</span><a href="Jikka.Python.Language.Expr.html#USub"><span class="hs-identifier hs-var">USub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatCmpOp"><span class="hs-identifier hs-type">formatCmpOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.Python.Language.Expr.html#CmpOp"><span class="hs-identifier hs-type">CmpOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-73"></span><span id="formatCmpOp"><span class="annot"><span class="annottext">formatCmpOp :: CmpOp -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatCmpOp"><span class="hs-identifier hs-var hs-var">formatCmpOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#Eq%27"><span class="hs-identifier hs-var">Eq'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;==&quot;</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#NotEq"><span class="hs-identifier hs-var">NotEq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!=&quot;</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#LtE"><span class="hs-identifier hs-var">LtE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#GtE"><span class="hs-identifier hs-var">GtE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#Is"><span class="hs-identifier hs-var">Is</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is&quot;</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#IsNot"><span class="hs-identifier hs-var">IsNot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not&quot;</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#In"><span class="hs-identifier hs-var">In</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in&quot;</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Jikka.Python.Language.Expr.html#NotIn"><span class="hs-identifier hs-var">NotIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not in&quot;</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatComprehension"><span class="hs-identifier hs-type">formatComprehension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Comprehension"><span class="hs-identifier hs-type">Comprehension</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-86"></span><span id="formatComprehension"><span class="annot"><span class="annottext">formatComprehension :: Comprehension -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatComprehension"><span class="hs-identifier hs-var hs-var">formatComprehension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Comprehension"><span class="hs-identifier hs-type">Comprehension</span></a></span><span> </span><span id="local-6989586621679297490"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297490"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679297489"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297489"><span class="hs-identifier hs-var">iter</span></a></span></span><span> </span><span id="local-6989586621679297488"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297488"><span class="hs-identifier hs-var">ifs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297487"><span class="annot"><span class="annottext">body :: String
</span><a href="#local-6989586621679297487"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var">formatTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297490"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297489"><span class="hs-identifier hs-var">iter</span></a></span><span>
</span><span id="line-88"></span><span>      </span><span id="local-6989586621679297484"><span class="annot"><span class="annottext">ifs' :: String
</span><a href="#local-6989586621679297484"><span class="hs-identifier hs-var hs-var">ifs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297488"><span class="hs-identifier hs-var">ifs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">Maybe Expr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679297483"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297483"><span class="hs-identifier hs-var">ifs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; if &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297483"><span class="hs-identifier hs-var">ifs</span></a></span><span>
</span><span id="line-91"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679297487"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679297484"><span class="hs-identifier hs-var">ifs'</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-type">formatTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Target"><span class="hs-identifier hs-type">Target</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-94"></span><span id="formatTarget"><span class="annot"><span class="annottext">formatTarget :: Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var hs-var">formatTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#SubscriptTrg"><span class="hs-identifier hs-type">SubscriptTrg</span></a></span><span> </span><span id="local-6989586621679297481"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297481"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679297480"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297480"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var">formatTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297481"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297480"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#NameTrg"><span class="hs-identifier hs-type">NameTrg</span></a></span><span> </span><span id="local-6989586621679297478"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297478"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarName -&gt; String
</span><a href="Jikka.RestrictedPython.Language.Expr.html#unVarName"><span class="hs-identifier hs-var">unVarName</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297478"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#TupleTrg"><span class="hs-identifier hs-type">TupleTrg</span></a></span><span> </span><span id="local-6989586621679297475"><span class="annot"><span class="annottext">[Target]
</span><a href="#local-6989586621679297475"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Target]
</span><a href="#local-6989586621679297475"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679297474"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297474"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var">formatTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297474"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,)&quot;</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">[Target]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Target -&gt; String) -&gt; [Target] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var">formatTarget</span></a></span><span> </span><span class="annot"><span class="annottext">[Target]
</span><a href="#local-6989586621679297475"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-type">formatExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-103"></span><span id="formatExpr"><span class="annot"><span class="annottext">formatExpr :: Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var hs-var">formatExpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#BoolOp"><span class="hs-identifier hs-type">BoolOp</span></a></span><span> </span><span id="local-6989586621679297472"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297472"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679297471"><span class="annot"><span class="annottext">BoolOp
</span><a href="#local-6989586621679297471"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679297470"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297470"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297472"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">BoolOp -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatBoolOp"><span class="hs-identifier hs-var">formatBoolOp</span></a></span><span> </span><span class="annot"><span class="annottext">BoolOp
</span><a href="#local-6989586621679297471"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297470"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span id="local-6989586621679297468"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297468"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679297467"><span class="annot"><span class="annottext">Operator
</span><a href="#local-6989586621679297467"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679297466"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297466"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297468"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Operator -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatOperator"><span class="hs-identifier hs-var">formatOperator</span></a></span><span> </span><span class="annot"><span class="annottext">Operator
</span><a href="#local-6989586621679297467"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297466"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#UnaryOp"><span class="hs-identifier hs-type">UnaryOp</span></a></span><span> </span><span id="local-6989586621679297464"><span class="annot"><span class="annottext">UnaryOp
</span><a href="#local-6989586621679297464"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679297463"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297463"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnaryOp -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatUnaryOp"><span class="hs-identifier hs-var">formatUnaryOp</span></a></span><span> </span><span class="annot"><span class="annottext">UnaryOp
</span><a href="#local-6989586621679297464"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297463"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679297461"><span class="annot"><span class="annottext">[(VarName, Type)]
</span><a href="#local-6989586621679297461"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679297460"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297460"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(VarName, Type)]
</span><a href="#local-6989586621679297461"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lambda: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297460"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">[(VarName, Type)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lambda &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((VarName, Type) -&gt; String) -&gt; [(VarName, Type)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarName -&gt; String
</span><a href="Jikka.RestrictedPython.Language.Expr.html#unVarName"><span class="hs-identifier hs-var">unVarName</span></a></span><span> </span><span class="annot"><span class="annottext">(VarName -&gt; String)
-&gt; ((VarName, Type) -&gt; VarName) -&gt; (VarName, Type) -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VarName, Type) -&gt; VarName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(VarName, Type)]
</span><a href="#local-6989586621679297461"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297460"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#IfExp"><span class="hs-identifier hs-type">IfExp</span></a></span><span> </span><span id="local-6989586621679297457"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297457"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679297456"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297456"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679297455"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297455"><span class="hs-identifier hs-var">e3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297456"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; if &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297457"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; else &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297455"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ListComp"><span class="hs-identifier hs-type">ListComp</span></a></span><span> </span><span id="local-6989586621679297453"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297453"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679297452"><span class="annot"><span class="annottext">Comprehension
</span><a href="#local-6989586621679297452"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297453"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Comprehension -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatComprehension"><span class="hs-identifier hs-var">formatComprehension</span></a></span><span> </span><span class="annot"><span class="annottext">Comprehension
</span><a href="#local-6989586621679297452"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Compare"><span class="hs-identifier hs-type">Compare</span></a></span><span> </span><span id="local-6989586621679297450"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297450"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679297449"><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621679297449"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679297448"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297448"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297450"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CmpOp -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatCmpOp"><span class="hs-identifier hs-var">formatCmpOp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621679297449"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297448"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span id="local-6989586621679297446"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297446"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679297445"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297445"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297445"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ListComp"><span class="hs-identifier hs-type">ListComp</span></a></span><span> </span><span id="local-6989586621679297444"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297444"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679297443"><span class="annot"><span class="annottext">Comprehension
</span><a href="#local-6989586621679297443"><span class="hs-identifier hs-var">comp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297446"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297444"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Comprehension -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatComprehension"><span class="hs-identifier hs-var">formatComprehension</span></a></span><span> </span><span class="annot"><span class="annottext">Comprehension
</span><a href="#local-6989586621679297443"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">[Expr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297446"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; String) -&gt; [Expr] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297445"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621679297441"><span class="annot"><span class="annottext">Constant
</span><a href="#local-6989586621679297441"><span class="hs-identifier hs-var">const</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Constant -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatConstant"><span class="hs-identifier hs-var">formatConstant</span></a></span><span> </span><span class="annot"><span class="annottext">Constant
</span><a href="#local-6989586621679297441"><span class="hs-identifier hs-var">const</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Subscript"><span class="hs-identifier hs-type">Subscript</span></a></span><span> </span><span id="local-6989586621679297439"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297439"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679297438"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297438"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297439"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297438"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621679297436"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297436"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarName -&gt; String
</span><a href="Jikka.RestrictedPython.Language.Expr.html#unVarName"><span class="hs-identifier hs-var">unVarName</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297436"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297434"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297434"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; String) -&gt; [Expr] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297434"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a></span><span> </span><span id="local-6989586621679297432"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297432"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297432"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679297431"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297431"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297431"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,)&quot;</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">[Expr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr -&gt; String) -&gt; [Expr] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679297432"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#SubscriptSlice"><span class="hs-identifier hs-type">SubscriptSlice</span></a></span><span> </span><span id="local-6989586621679297429"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297429"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679297428"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297428"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679297427"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297427"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679297426"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297426"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297425"><span class="annot"><span class="annottext">from' :: String
</span><a href="#local-6989586621679297425"><span class="hs-identifier hs-var hs-var">from'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Expr -&gt; String) -&gt; Maybe Expr -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297428"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679297423"><span class="annot"><span class="annottext">to' :: String
</span><a href="#local-6989586621679297423"><span class="hs-identifier hs-var hs-var">to'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Expr -&gt; String) -&gt; Maybe Expr -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297427"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621679297422"><span class="annot"><span class="annottext">step' :: String
</span><a href="#local-6989586621679297422"><span class="hs-identifier hs-var hs-var">step'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Expr -&gt; String) -&gt; Maybe Expr -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (Expr -&gt; String) -&gt; Expr -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679297426"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-128"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297429"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679297425"><span class="hs-identifier hs-var">from'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679297423"><span class="hs-identifier hs-var">to'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679297422"><span class="hs-identifier hs-var">step'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-type">formatStatement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span id="formatStatement"><span class="annot"><span class="annottext">formatStatement :: Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var hs-var">formatStatement</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Return"><span class="hs-identifier hs-type">Return</span></a></span><span> </span><span id="local-6989586621679297419"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297419"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297419"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#AugAssign"><span class="hs-identifier hs-type">AugAssign</span></a></span><span> </span><span id="local-6989586621679297417"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297417"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679297416"><span class="annot"><span class="annottext">Operator
</span><a href="#local-6989586621679297416"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679297415"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297415"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var">formatTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297417"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Operator -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatOperator"><span class="hs-identifier hs-var">formatOperator</span></a></span><span> </span><span class="annot"><span class="annottext">Operator
</span><a href="#local-6989586621679297416"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;= &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297415"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#AnnAssign"><span class="hs-identifier hs-type">AnnAssign</span></a></span><span> </span><span id="local-6989586621679297413"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297413"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679297412"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297412"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679297411"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297411"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var">formatTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297413"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297412"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297411"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#For"><span class="hs-identifier hs-type">For</span></a></span><span> </span><span id="local-6989586621679297409"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297409"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679297408"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297408"><span class="hs-identifier hs-var">iter</span></a></span></span><span> </span><span id="local-6989586621679297407"><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297407"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Target -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatTarget"><span class="hs-identifier hs-var">formatTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621679297409"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297408"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; [String]) -&gt; [Statement] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var">formatStatement</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297407"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#dedent"><span class="hs-identifier hs-var">dedent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span id="local-6989586621679297402"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297402"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679297401"><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297401"><span class="hs-identifier hs-var">body1</span></a></span></span><span> </span><span id="local-6989586621679297400"><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297400"><span class="hs-identifier hs-var">body2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297400"><span class="hs-identifier hs-var">body2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297402"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; [String]) -&gt; [Statement] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var">formatStatement</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297401"><span class="hs-identifier hs-var">body1</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#dedent"><span class="hs-identifier hs-var">dedent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679297399"><span class="annot"><span class="annottext">body2 :: Statement
</span><a href="#local-6989586621679297399"><span class="hs-identifier hs-var">body2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297398"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679297398"><span class="hs-identifier hs-var">elif</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679297397"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679297397"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var">formatStatement</span></a></span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679297399"><span class="hs-identifier hs-var">body2</span></a></span><span>
</span><span id="line-140"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297402"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; [String]) -&gt; [Statement] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var">formatStatement</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297401"><span class="hs-identifier hs-var">body1</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#dedent"><span class="hs-identifier hs-var">dedent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;el&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679297398"><span class="hs-identifier hs-var">elif</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679297397"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">[Statement]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297402"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; [String]) -&gt; [Statement] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var">formatStatement</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297401"><span class="hs-identifier hs-var">body1</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#dedent"><span class="hs-identifier hs-var">dedent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;else:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; [String]) -&gt; [Statement] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var">formatStatement</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297400"><span class="hs-identifier hs-var">body2</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#dedent"><span class="hs-identifier hs-var">dedent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621679297395"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297395"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assert &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297395"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatToplevelStatement"><span class="hs-identifier hs-type">formatToplevelStatement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ToplevelStatement"><span class="hs-identifier hs-type">ToplevelStatement</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span id="formatToplevelStatement"><span class="annot"><span class="annottext">formatToplevelStatement :: ToplevelStatement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatToplevelStatement"><span class="hs-identifier hs-var hs-var">formatToplevelStatement</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ToplevelAnnAssign"><span class="hs-identifier hs-type">ToplevelAnnAssign</span></a></span><span> </span><span id="local-6989586621679297392"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297392"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679297391"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297391"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679297390"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297390"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VarName -&gt; String
</span><a href="Jikka.RestrictedPython.Language.Expr.html#unVarName"><span class="hs-identifier hs-var">unVarName</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297392"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297391"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297390"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ToplevelFunctionDef"><span class="hs-identifier hs-type">ToplevelFunctionDef</span></a></span><span> </span><span id="local-6989586621679297388"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297388"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679297387"><span class="annot"><span class="annottext">[(VarName, Type)]
</span><a href="#local-6989586621679297387"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679297386"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297386"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span id="local-6989586621679297385"><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297385"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;def &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VarName -&gt; String
</span><a href="Jikka.RestrictedPython.Language.Expr.html#unVarName"><span class="hs-identifier hs-var">unVarName</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297388"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((VarName, Type) -&gt; String) -&gt; [(VarName, Type)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679297384"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297384"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297383"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297383"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarName -&gt; String
</span><a href="Jikka.RestrictedPython.Language.Expr.html#unVarName"><span class="hs-identifier hs-var">unVarName</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621679297384"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297383"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(VarName, Type)]
</span><a href="#local-6989586621679297387"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) -&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatType"><span class="hs-identifier hs-var">formatType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679297386"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; [String]) -&gt; [Statement] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatStatement"><span class="hs-identifier hs-var">formatStatement</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679297385"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="Jikka.Common.Format.AutoIndent.html#dedent"><span class="hs-identifier hs-var">dedent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#ToplevelAssert"><span class="hs-identifier hs-type">ToplevelAssert</span></a></span><span> </span><span id="local-6989586621679297381"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297381"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assert &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#formatExpr"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679297381"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#formatProgram"><span class="hs-identifier hs-type">formatProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-151"></span><span id="formatProgram"><span class="annot"><span class="annottext">formatProgram :: Program -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatProgram"><span class="hs-identifier hs-var hs-var">formatProgram</span></a></span></span><span> </span><span id="local-6989586621679297379"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679297379"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ToplevelStatement -&gt; [String]) -&gt; Program -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">ToplevelStatement -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatToplevelStatement"><span class="hs-identifier hs-var">formatToplevelStatement</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679297379"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Jikka.RestrictedPython.Format.html#run%27"><span class="hs-identifier hs-type">run'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-154"></span><span id="run%27"><span class="annot"><span class="annottext">run' :: Program -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#run%27"><span class="hs-identifier hs-var hs-var">run'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; (Program -&gt; [String]) -&gt; Program -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
</span><a href="Jikka.Common.Format.AutoIndent.html#makeIndentFromMarkers"><span class="hs-identifier hs-var">makeIndentFromMarkers</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; (Program -&gt; [String]) -&gt; Program -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Program -&gt; [String]
</span><a href="Jikka.RestrictedPython.Format.html#formatProgram"><span class="hs-identifier hs-var">formatProgram</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621679297376"><span class="annot"><a href="Jikka.RestrictedPython.Format.html#run"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679297376"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Jikka.RestrictedPython.Language.Expr.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679297376"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span><span>
</span><span id="line-157"></span><span id="run"><span class="annot"><span class="annottext">run :: Program -&gt; m Text
</span><a href="Jikka.RestrictedPython.Format.html#run"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Text) -&gt; (Program -&gt; Text) -&gt; Program -&gt; m Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (Program -&gt; String) -&gt; Program -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Program -&gt; String
</span><a href="Jikka.RestrictedPython.Format.html#run%27"><span class="hs-identifier hs-var">run'</span></a></span><span>
</span><span id="line-158"></span></pre></body></html>